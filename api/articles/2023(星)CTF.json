{"title":"2023(星)CTF","uid":"4b46cdd516927b937a38437aec23a08d","slug":"2023(星)CTF","date":"2023-07-30T12:49:04.825Z","updated":"2023-09-05T01:13:48.493Z","comments":true,"path":"api/articles/2023(星)CTF.json","keywords":null,"cover":"/img/43.jpg","content":"<p><code>咋只有一道web，全是ai题</code></p>\n<span id=\"more\"></span>\n\n<h1 id=\"jwt2struts\"><a href=\"#jwt2struts\" class=\"headerlink\" title=\"jwt2struts\"></a>jwt2struts</h1><p>看题目猜测考点是<code>jwt伪造+s2漏洞</code></p>\n<p>进入网站，发现是需要admin身份，也确实是jwt伪造</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230731095441281.png\" alt=\"image-20230731095441281\"></p>\n<h2 id=\"解析jwt\"><a href=\"#解析jwt\" class=\"headerlink\" title=\"解析jwt\"></a>解析jwt</h2><p>用<a href=\"https://jwt.io/\">JSON Web Tokens - jwt.io</a>进行解析，发现确实是jwt</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230731142627322.png\" alt=\"image-20230731142627322\"></p>\n<p>但是不知道密钥，</p>\n<p>先尝试是不是空密钥，直接修改为admin</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230731155151954.png\" alt=\"image-20230731155151954\"></p>\n<p>得到新的<code>jwt</code></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MjAwNjM5MzI5N30.L0YCThgRESeqIu8mUgr_IjD6CYadVNFH4sQ29w40nnU</p></blockquote>\n<p>代入再次访问网站</p>\n<p>结果提示<code>token</code>无效，</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230731155331700.png\" alt=\"image-20230731155331700\"></p>\n<p>查看网页源码发现</p>\n<p>提示<code>JWT_key.php</code></p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230731155922977.png\" alt=\"image-20230731155922977\"></p>\n<p>这应该就是jwt生成和身份验证的php代码</p>\n<p>访问得到代码</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;./secret_key.php&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;./salt.php&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span></span><br><span class=\"line\"><span class=\"comment\">//md5($salt.&quot;adminroot&quot;)=e6ccbf12de9d33ec27a5bcfb6a3293df</span></span><br><span class=\"line\">@<span class=\"variable\">$username</span> = <span class=\"title function_ invoke__\">urldecode</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;username&quot;</span>]);</span><br><span class=\"line\">@<span class=\"variable\">$password</span> = <span class=\"title function_ invoke__\">urldecode</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;password&quot;</span>]);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!<span class=\"keyword\">empty</span>(<span class=\"variable\">$_COOKIE</span>[<span class=\"string\">&quot;digest&quot;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$username</span> === <span class=\"string\">&quot;admin&quot;</span> &amp;&amp; <span class=\"variable\">$password</span> != <span class=\"string\">&quot;root&quot;</span>) &#123;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (<span class=\"variable\">$_COOKIE</span>[<span class=\"string\">&quot;digest&quot;</span>] === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$salt</span>.<span class=\"variable\">$username</span>.<span class=\"variable\">$password</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span> (<span class=\"string\">&quot;The secret_key is &quot;</span>. <span class=\"variable\">$secret_key</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span> (<span class=\"string\">&quot;Your cookies don&#x27;t match up! STOP HACKING THIS SITE.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span> (<span class=\"string\">&quot;no no no&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">no no no</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"分析代码\"><a href=\"#分析代码\" class=\"headerlink\" title=\"分析代码\"></a>分析代码</h2><p>发现想要得到key，关键在于这段条件语句的绕过</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$username</span> === <span class=\"string\">&quot;admin&quot;</span> &amp;&amp; <span class=\"variable\">$password</span> != <span class=\"string\">&quot;root&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$_COOKIE</span>[<span class=\"string\">&quot;digest&quot;</span>] === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$salt</span>.<span class=\"variable\">$username</span>.<span class=\"variable\">$password</span>)) &#123;</span><br><span class=\"line\">           <span class=\"keyword\">die</span> (<span class=\"string\">&quot;The secret_key is &quot;</span>. <span class=\"variable\">$secret_key</span>);</span><br></pre></td></tr></table></figure>\n\n<p><code>$username</code>和<code>$password</code>好实现</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><code>username</code>:<code>admin</code>，<code>password</code>:除了<code>root</code>以为的字符</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><code>$_COOKIE[&quot;digest&quot;]</code>要求为<code>md5($salt.$username.$password)</code></p></blockquote>\n<p>也就是<code>$_COOKIE[&quot;digest&quot;]</code>要为<code>盐+名字+密码</code>的字符串的md5值</p>\n<p>现在知道，</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>盐的长度是<code>14</code>，</p>\n<p>且<code>md5($salt.&quot;adminroot&quot;)=e6ccbf12de9d33ec27a5bcfb6a3293df</code></p></blockquote>\n<h2 id=\"hash长度拓展攻击\"><a href=\"#hash长度拓展攻击\" class=\"headerlink\" title=\"hash长度拓展攻击\"></a>hash长度拓展攻击</h2><p>对于这种未知salt，但又要进行绕过MD5或者sha1加密的，就可以考虑用<code>hash长度拓展攻击</code></p>\n<p><a href=\"https://j-kangel.github.io/2019/04/05/hash-attack/\">hash长度扩展攻击 | KANGEL (j-kangel.github.io)</a></p>\n<p>【个人分析写在笔记上】</p>\n<p>利用工具<code>hashdump</code></p>\n<figure class=\"highlight hsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Input</span> Signature                    <span class=\"meta\">#现有哈希值（题目给的MD5）</span></span><br><span class=\"line\"><span class=\"keyword\">Input</span> Data                         <span class=\"meta\">#已知字符串</span></span><br><span class=\"line\"><span class=\"keyword\">Input</span> Key <span class=\"keyword\">Length</span>                   <span class=\"meta\">#为密文（salt）长度</span></span><br><span class=\"line\"><span class=\"keyword\">Input</span> Data to Add                  <span class=\"meta\">#为补位后自己加的字符串（自定义）</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801211703847.png\" alt=\"image-20230801211703847\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Input Signature: e6ccbf12de9d33ec27a5bcfb6a3293df<br>Input Data: adminroot<br>Input Key Length: 14<br>Input Data to Add: Jay<br>8ae52974e81aace9837123a520cb8179<br>adminroot\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xb8\\x00\\x00\\x00\\x00\\x00\\x00\\x00Jay</p></blockquote>\n<p>然后把<code>\\x</code>换成<code>%</code></p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801211736595.png\" alt=\"image-20230801211736595\"></p>\n<p>此时，</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><code>$_COOKIE[&quot;digest&quot;]</code></p>\n<p>就为<code>Cookie: digest=8ae52974e81aace9837123a520cb8179</code></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><code>$username</code>和<code>$password</code></p>\n<p>就为<code>admin</code>和<code>root%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%b8%00%00%00%00%00%00%00Jay</code></p></blockquote>\n<p>然后修改请求包内容</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801212115216.png\" alt=\"image-20230801212115216\"></p>\n<p>得到<code>sercret_key</code>为<code>sk-he00lctf3r</code></p>\n<p>然后修改jwt，进行jwt伪造</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801215103147.png\" alt=\"image-20230801215103147\"></p>\n<p>然后修改网站的<code>token</code></p>\n<p>刷新后，网站跳转<code>http://140.210.223.216:55557/admiiiiiiiiiiin/</code>，</p>\n<p>网站的名字就叫<code>do you know struct2?</code></p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801215237349.png\" alt=\"image-20230801215237349\"></p>\n<p>确定这里是需要利用<code>s2</code>漏洞</p>\n<p>抓包查看这个网页提交请求包</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801215510347.png\" alt=\"image-20230801215510347\"></p>\n<p>发现是发向<code>/admiiiiiiiiiiin/user.action</code></p>\n<p>直接用工具也可以</p>\n<p>flag在环境变量里，执行<code>env</code>可以看到</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801215357776.png\" alt=\"image-20230801215357776\"></p>\n<p>burp发包也可以，只是需要将<code>s2</code>的payload进行url编码即可</p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230801215658845.png\" alt=\"image-20230801215658845\"></p>\n<hr>\n<h2 id=\"ps-jwt-cracker【非预期无法解】\"><a href=\"#ps-jwt-cracker【非预期无法解】\" class=\"headerlink\" title=\"ps.jwt-cracker【非预期无法解】\"></a>ps.jwt-cracker【非预期无法解】</h2><p>本来是想用<code>jwt-cracker</code>进行爆破<code>jwt</code>的<code>secret</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull epsilon95/jwtcrack</span><br><span class=\"line\"></span><br><span class=\"line\">docker run -it --<span class=\"built_in\">rm</span> jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyIiwiZXhwIjoyMDA2MzkzMjk3fQ.bQxqRhEOZkHV3NweYcdVKO_0WKrSDIb4ExcB-9UZRk0</span><br></pre></td></tr></table></figure>\n\n<p>结果CPU跑飞了也没爆破出来，看来是不是非预期能解出来，只能考虑<code>hash长度拓展攻击</code></p>\n<p><img src=\"/post/2023(%E6%98%9F)CT/image-20230731171850197.png\" alt=\"image-20230731171850197\"></p>\n<h2 id=\"脚本利用rockyou爆破salt【不知道是不是预期可行】\"><a href=\"#脚本利用rockyou爆破salt【不知道是不是预期可行】\" class=\"headerlink\" title=\"脚本利用rockyou爆破salt【不知道是不是预期可行】\"></a>脚本利用rockyou爆破salt【不知道是不是预期可行】</h2><p><img src=\"/post/2023(%E6%98%9F)CT/image-20230905090421230.png\" alt=\"image-20230905090421230\"></p>\n<p>在<code>rockyou.txt</code>中有这个key，说明可以利用这个方法进行爆破，写个脚本即可进行</p>\n<p>过滤rockyou中长度为14的字符，然后加到</p>\n<p>adminroot前进行MD5计算使得计算后的值为</p>\n<p><code>e6ccbf12de9d33ec27a5bcfb6a3293df</code></p>\n<p>&#x3D;&gt;</p>\n<p>最后我们就可以爆破出salt为<code>sk-he00lctf3r</code></p>\n<p>最后只要密码随便修改为<code>root1</code>即可，然后再MD5计算一次得到<code>cookie</code>值</p>\n","text":"咋只有一道web，全是ai题 jwt2struts看题目猜测考点是jwt伪造+s2漏洞 进入网站，发现是需要admin身份，也确实是jwt伪造 解析jwt用JS...","permalink":"/post/2023(星)CTF","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"网络安全学习","slug":"网络安全学习","count":26,"path":"api/categories/网络安全学习.json"}],"tags":[{"name":"Game","slug":"Game","count":12,"path":"api/tags/Game.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#jwt2struts\"><span class=\"toc-text\">jwt2struts</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E6%9E%90jwt\"><span class=\"toc-text\">解析jwt</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%86%E6%9E%90%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">分析代码</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#hash%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB\"><span class=\"toc-text\">hash长度拓展攻击</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ps-jwt-cracker%E3%80%90%E9%9D%9E%E9%A2%84%E6%9C%9F%E6%97%A0%E6%B3%95%E8%A7%A3%E3%80%91\"><span class=\"toc-text\">ps.jwt-cracker【非预期无法解】</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%84%9A%E6%9C%AC%E5%88%A9%E7%94%A8rockyou%E7%88%86%E7%A0%B4salt%E3%80%90%E4%B8%8D%E7%9F%A5%E9%81%93%E6%98%AF%E4%B8%8D%E6%98%AF%E9%A2%84%E6%9C%9F%E5%8F%AF%E8%A1%8C%E3%80%91\"><span class=\"toc-text\">脚本利用rockyou爆破salt【不知道是不是预期可行】</span></a></li></ol></li></ol>","author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"必须从过去的错误学习教训，而非依赖过去的成功","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Java安全[反射(2)]","uid":"d574ea4f3aa1b406fd1d29f7afa502ba","slug":"Java安全[反射(2)]","date":"2023-08-23T01:46:39.171Z","updated":"2023-09-09T08:38:50.672Z","comments":true,"path":"api/articles/Java安全[反射(2)].json","keywords":null,"cover":"/img/50.jpg","text":"Java学好的主要性太大了，之前我一直没总体归纳，这次彻底狠狠的深入 主要阅读p牛的&lt;&lt;Java安全漫谈&gt;&gt; Java安全[反射(2)]...","permalink":"/post/Java安全[反射(2)]","photos":[],"count_time":{"symbolsCount":"5.1k","symbolsTime":"5 mins."},"categories":[{"name":"Java漫谈学习","slug":"Java漫谈学习","count":6,"path":"api/categories/Java漫谈学习.json"}],"tags":[{"name":"Java","slug":"Java","count":7,"path":"api/tags/Java.json"}],"author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"必须从过去的错误学习教训，而非依赖过去的成功","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Apache shiro-550反序列化漏洞分析","uid":"5abffa5265ef71790df12abfc2dd6b2a","slug":"Apache_shiro-550反序列化漏洞分析","date":"2023-07-21T13:40:36.963Z","updated":"2023-09-25T14:57:45.369Z","comments":true,"path":"api/articles/Apache_shiro-550反序列化漏洞分析.json","keywords":null,"cover":"/img/1.jpg","text":"很重要，经典 Apache shiro-550反序列化漏洞分析前言 中间件介绍： Apache Shiro是一个强大且易用的Java安全框架,执行身份验证、授权...","permalink":"/post/Apache_shiro-550反序列化漏洞分析","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"Java","slug":"Java","count":1,"path":"api/categories/Java.json"}],"tags":[{"name":"Java","slug":"Java","count":7,"path":"api/tags/Java.json"}],"author":{"name":"Ttoc","slug":"blog-author","avatar":"/static/img/logo.png","link":"/","description":"必须从过去的错误学习教训，而非依赖过去的成功","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}